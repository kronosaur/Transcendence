<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

<!-- STAR SYSTEMS =============================================================

	Creating a random star system consists of two main processes: 1) we 
	generate random planets, asteroids, and nebulae; 2) we place stations and
	encounters randomly around appropriate locations.

	OBJECT TYPES

	Object types (implemented as a StationType) represent specific planets
	and asteroids. Specific object types have the following properties:

	CLASSIFICATION		An object's classification represents the type or kind
						of object. For example, some objects are "volcanic"
						while others are "primordial". This library defines
						several classifications, but additional libraries may
						defines an arbitrary number of new classifications.

						Generally, a classification encompasses something unique
						about the objects in the class.

	SIZE				An object has a specific size (in kilometers) that can
						be placed into one of 13 size classes:

								Asteroid			< 1,000 km
						sizeA		Tiny			~ 10 km
						sizeB		Small			~ 50 km
						sizeC		Medium			~ 100 km
						sizeD		Large			~ 500 km

								Planetoid			~ 2,500 km
						sizeE		Small			~ 1,000 km
						sizeF		Medium			~ 2,000	km
						sizeG		Large			~ 4,000 km
		
								Terrestrial			~ 10,000 km
						sizeH		Small			~ 5,000 km
						sizeI		Medium			~ 10,000 km
						sizeJ		Large			~ 20,000 km

								Gas Giant			~ 100,000 km
						sizeK		Small			~ 50,000 km
						sizeL		Medium			~ 100,000 km
						sizeM		Large			~ 200,000 km

	REGION				An object may appear different depending on its distance
						from the central star. For example, some objects may have
						a coating of ice when far away. For purposes of object
						appearence, there are three regions:

						inner		Inner objects are baked by the central star.

						lifeZone	LifeZone objects are at the right distance 
									to possibly support liquid water (although
									they are not required).

						outer		Outer objects are frozen.

	Every concrete object type (represented by a StationType) has the above 
	properties. For example, stPrimordialInnerAsteroidSizeA implements an object
	with the following properties:

		classification: primordial
		size: A
		region: inner
	
	In general, each StationType should have a unique combination of properties.
	If an object with identical properties can have multiple appearences, then
	it should generally be implemented as multiple image variants within a 
	single StationType.

	Object types should include these properties in their attributes. For 
	example, stPrimordialAsteroidSizeA should have the following attributes:

	primordial			The classification
	sizeA				The size
	lifeZone			The region

	If the object type can be found in multiple regions, then it should have
	all of the appropriate regions listed. In addition, all object types should
	have the attribute "generic" if they wish to be selected randomly in a
	system morphology.

	SYSTEM MORPHOLOGIES

	A system morphology defines the form and configuration of a specific kind
	of system. For example, the AsteroidArcBeltSystem definition creates a 
	system with a K-class star and asteroid belts.

	System morphologies are designed to be included in a SystemType definitions.
	The SystemType is responsible for binding the physical characteristics of
	the system (its morphology) with the stations and encounters that are 
	appropriate to it.

	For example, there could be two (or more) different SystemTypes that include
	the AsteroidArcBeltSystem: One might be a friendly Commonwealth system with
	a heavy Commonwealth presence; the other might define an enemy system with
	lots of Ranx stations.
	
	The tbSystemMorphologies table contains all of the system morphologies
	defined by this library.

	SYSTEM ZONES

	The system morphologies in this library could, laboriously, define the 
	system in terms of specific object types. For example, a morphology could
	randomly place a size A primordial asteroid in the inner region. But this
	would duplicate lots of code.

	Instead, the morphologies use the concept of "zones" to help place specific
	object types. There are twelve zone types defined in this library:

						Inner Zones			Life Zones			Outer Zones
					 ===========================================================
	Metallic Zones	 |	molten				metallic			barren
	Organic Zones	 |	greenhouse			primordial			tholin
	Rocky Zones		 |	cinder				desert				frost
	Water Zones		 |	steam				biosphere			ice

	In general, each system morphology picks an approprize zone for its inner,
	lifeZone and outer regions. For example, the VolcanicSystem morphology might
	pick molten for its inner zone, desert for its lifezone and barren for its
	outer zone.

	The system morphology then uses "group morphologies" to place asteroids
	and planets. The group morphologies will determined the zone in which they
	have been placed to pick specific object types.

	Example: The VolcanicSystem morphology defines the inner zone to be molten.
	It then creates an AsteroidSparseBeltMorph in the inner zone. The
	definition of AsteroidSpareseBeltMorph picks a different set of random
	asteroids depending on the zone it finds itself in. For molten zone it picks
	lots of volcanic asteroids.

	NOTE: These zones are an implementation detail of the system morphologies
	defined in this library. Do not assume that these are the only zones 
	available nor that systems must have a certain set of zones.

	EXTENSIONS

	Extensions and libraries using this library should follow these guidelines:

	1.	DO use any of the object types (StationTypes) defined in this library.
	2.	DO define your own object types, but DO NOT expect them to be 
		automatically selected by morphologies in this library.
	3.	DO define your own SystemTypes. DO include any system morphology defined
		in this library.
	4.	DO use any group morphology defined in this library.
	5.	DO define your own morphology tables and use them in your own 
		SystemTypes. Your own tables may include these object types or your own
		object types.

	DISTANCE ATTRIBUTES

	innerSystem			Hot zone; 60% of max star illumination
	lifeZone			Lize zone; from end of inner to edge of illumination
	outerSystem			Outsize star's max illumination

	COMPOSITION ATTRIBUTES

	metallicComp		High metallic content
	organicComp			High organic content
	rockyComp			High rock content
	waterComp			High water content

	ZONE ATTRIBUTES

	barrenZone			metallic, outer
	biosphereZone		water, lifeZone
	cinderZone			rocky, inner
	desertZone			rocky, lifeZone
	frostZone			rocky, outer
	greenhouseZone		organic, inner
	iceZone				water, outer
	metallicZone		metallic, lifeZone
	moltenZone			metallic, inner
	primordialZone		organic, lifeZone
	steamZone			water, inner
	tholinZone			organic, outer

	OBJECT ATTRIBUTES

	asteroids			among asteroids
	asteroidbelt		among asteroid belt around star
	cratered			in orbit around cratered planet/moon
	desert				in orbit around desert planet/moon
	earthlike			in orbit around earthlike planet/moon
	frost				among frost asteroids
	gasgiant			near gas-giant planet
	ice					among ice asteroids
	methanegiant		near methane-giant planet
	moon				in orbit around large moon
	nebulae				in a nebula
	ocean				in orbit around ocean planet/moon
	planet				in orbit around primary planet
	planetary			in orbit around planet or large moon
	poisonous			in orbit around poisonous planet/moon
	radioactive			in orbit around radioactive planet/moon
	ringedgiant			near ringed-giant planet
	trojan				at trojan (or antitrojan) point
	volcanic			in orbit around volcanic planet/moon

	LABEL HIERARCHY

	asteroids
		asteroidbelt
		comet
		frost
		ice

	planetary
		moon
			cratered
			desert
			earthlike
			ocean
			poisonous
			radioactive
			volcanic
		planet
			cratered
			desert
			earthlike
			frost
			gasgiant
			methanegiant
			ocean
			poisonous
			radioactive
			ringedgiant
			volcanic

	trojan
	void

-->

	<SystemPartTable unid="&tbSystemMorphologies;">

		<!-- ASTEROID ARC BELT SYSTEM ==========================================

			Arc Belt
			Metallic

		-->

		<AsteroidArcBeltSystem>
			<Group>
				<Station type="&stK-TypeStar;"/>

				<AddAttribute attributes="asteroidBeltSystem, GTypeSystem"/>

				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="60"	minRadius="0"		maxRadius="370"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="5"	minRadius="0"		maxRadius="370"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="370"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="5"	minRadius="0"		maxRadius="370"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="60"	minRadius="370"		maxRadius="620"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="5"	minRadius="370"		maxRadius="620"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="30"	minRadius="370"		maxRadius="620"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="5"	minRadius="370"		maxRadius="620"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="60"	minRadius="620"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="0"	minRadius="620"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="10"	minRadius="620"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="6-8" BodeDistanceStart="80" BodeDistanceEnd="1000" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="20" table="DesertPrimary"/>
							<Lookup chance="40" table="MetallicPrimary"/>
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="5"  table="HydrogenGasGiantPrimary"/>
							<Lookup chance="15" table="MethaneGasGiantPrimary"/>
						</Table>
						<Lookup	maxRadius="480" table="AsteroidArcBeltLarge"/>
						<Table maxRadius="750">
							<Lookup chance="2"  table="DesertPrimary"/>
							<Lookup chance="5"  table="IcePrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="6"  table="RockyPrimary"/>
							<Lookup chance="70" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="3"  table="AsteroidBelt25"/>
						</Table>
						<Table maxRadius="1200">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="25" table="IcePrimary"/>
							<Lookup chance="20" table="MetallicPrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
							<Lookup chance="10" table="AsteroidBelt12"/>
							<Lookup chance="5"	table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</AsteroidArcBeltSystem>

		<!-- ASTEROID BELT SYSTEM ==============================================

			Asteroid Belt
			Rocky

		-->

		<AsteroidBeltSystem>
			<Group>
				<Station type="&stK-TypeStar;"/>

				<AddAttribute attributes="asteroidBeltSystem, GTypeSystem"/>

				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="370"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="5"	minRadius="0"		maxRadius="370"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="60"	minRadius="0"		maxRadius="370"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="5"	minRadius="0"		maxRadius="370"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="370"		maxRadius="620"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="5"	minRadius="370"		maxRadius="620"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="60"	minRadius="370"		maxRadius="620"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="5"	minRadius="370"		maxRadius="620"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="0"	minRadius="620"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="60"	minRadius="620"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="10"	minRadius="620"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="5-7" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="20" table="DesertPrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="50" table="RockyPrimary"/>
							<Lookup chance="5"  table="HydrogenGasGiantPrimary"/>
							<Lookup chance="15" table="MethaneGasGiantPrimary"/>
						</Table>
						<Lookup	maxRadius="450" table="AsteroidBelt500"/>
						<Table maxRadius="600">
							<Lookup chance="2"  table="DesertPrimary"/>
							<Lookup chance="6"  table="RockyPrimary"/>
							<Lookup chance="5"  table="IcePrimary"/>
							<Lookup chance="80" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="3"  table="AsteroidBelt25"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="25" table="IcePrimary"/>
							<Lookup chance="30" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
							<Lookup chance="10" table="AsteroidBelt12"/>
							<Lookup chance="5"	table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</AsteroidBeltSystem>

		<!-- BINARY SYSTEM (YELLOW STAR AND RED DWARF) =========================

			Binary

		-->

		<YellowStarAndRedDwarfBinarySystem>
			<Group>
				<AddAttribute attributes="binarySystem"/>

				<!-- Primary Star -->

				<Lookup table="YellowStarSystem"/>

				<!-- Void Encounters -->

				<Orbitals count="16" distance="3d200+240" angle="random" exclusionRadius="100">
					<Label attributes="void"/>
				</Orbitals>

				<!-- Companion Star System -->

				<Orbitals distance="1800-2000" angle="330-390" eccentricity="1d10+20" rotation="random">
					<Group>
						<Lookup table="RedDwarfSystem"/>

						<!-- Void Encounters -->

						<Orbitals count="12" distance="3d150+240" angle="random" exclusionRadius="100">
							<Label attributes="void"/>
						</Orbitals>
					</Group>
				</Orbitals>
			</Group>
		</YellowStarAndRedDwarfBinarySystem>

		<!-- DESERT SYSTEM =====================================================

			Hot
			Rocky

		-->

		<DesertSystem>
			<Group>
				<Station type="&stA-TypeStar;"/>

				<AddAttribute attributes="ATypeSystem"/>

				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="480"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="480"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="60"	minRadius="0"		maxRadius="480"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="0"	minRadius="0"		maxRadius="480"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="480"		maxRadius="800"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="10"	minRadius="480"		maxRadius="800"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="60"	minRadius="480"		maxRadius="800"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="0"	minRadius="480"		maxRadius="800"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="800"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="0"	minRadius="800"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="60"	minRadius="800"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="10"	minRadius="800"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="5-7" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="60" table="DesertPrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
						</Table>
						<Table maxRadius="500">
							<Lookup chance="20" table="DesertPrimary"/>
							<Lookup chance="5"  table="GreenhousePrimary"/>
							<Lookup chance="5"  table="MetallicPrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="60" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="3"  table="AsteroidBelt25"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="40" table="DesertPrimary"/>
							<Lookup chance="5"  table="MetallicPrimary"/>
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
							<Lookup chance="10" table="AsteroidBelt12"/>
							<Lookup chance="5"	table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</DesertSystem>

		<!-- LIGHT NEBULA SYSTEM ===============================================

			Nebula

		-->

		<LightNebulaSystem>
			<Group>
				<Station type="&stNebulaStar;"/>

				<AddAttribute attributes="GTypeSystem, nebulaSystem"/>
				
				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="240"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="240"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="40"	minRadius="0"		maxRadius="240"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="20"	minRadius="0"		maxRadius="240"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="240"		maxRadius="400"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="30"	minRadius="240"		maxRadius="400"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="40"	minRadius="240"		maxRadius="400"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="20"	minRadius="240"		maxRadius="400"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="400"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="30"	minRadius="400"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="30"	minRadius="400"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="30"	minRadius="400"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Nebulae -->

				<Orbitals distance="4" scale="light-minute" angle="random">
					<SpaceEnvironment 
							type=			"&seLightNebula;"
							shape=			"circular" 
							width=			"120"
							widthVariation=	"100"

							patchType=		"&efNebula;"
							patchFrequency=	"50"

							encountersCount="1d4+2"
							>
						<Label attributes="nebulae"/>
					</SpaceEnvironment>
				</Orbitals>

				<Orbitals count="2d3+1" distance="1d10+4" scale="light-minute" angle="random">
					<SpaceEnvironment 
							type=			"&seLightNebula;"
							shape=			"arc" 
							width=			"100"
							widthVariation=	"100"
							span=			"1d40+50"

							patchType=		"&efNebula;"
							patchFrequency=	"50"

							encountersCount="1d2"
							>
						<Label attributes="nebulae"/>
					</SpaceEnvironment>
				</Orbitals>

				<!-- Worlds -->

				<Orbitals count="4-6" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="10" table="GreenhousePrimary"/>
							<Lookup chance="5"  table="MetallicPrimary"/>
							<Lookup chance="20" table="PrimordialPrimary"/>
							<Lookup chance="35" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
						</Table>
						<Table maxRadius="500">
							<Lookup chance="5"  table="DesertPrimary"/>
							<Lookup chance="5"  table="PrimordialPrimary"/>
							<Lookup chance="8"  table="RockyPrimary"/>
							<Lookup chance="5"  table="IcePrimary"/>
							<Lookup chance="70" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="3"  table="AsteroidBelt25"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="10" table="PrimordialPrimary"/>
							<Lookup chance="20" table="IcePrimary"/>
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="10" table="GasGiantPrimary"/>
							<Lookup chance="25" table="PrimordialGasGiantPrimary"/>
							<Lookup chance="3"  table="AsteroidBelt12"/>
							<Lookup chance="2"  table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</LightNebulaSystem>

		<!-- PRIMORDIAL SYSTEM =================================================

			Primordial (Organic)

		-->

		<PrimordialSystem>
			<Group>
				<Station type="&stPrimordialStar;"/>

				<AddAttribute attributes="GTypeSystem, primordialSystem"/>
				
				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="240"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="60"	minRadius="0"		maxRadius="240"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="240"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="0"	minRadius="0"		maxRadius="240"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="5"	minRadius="240"		maxRadius="400"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="80"	minRadius="240"		maxRadius="400"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="10"	minRadius="240"		maxRadius="400"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="5"	minRadius="240"		maxRadius="400"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="400"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="60"	minRadius="400"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="20"	minRadius="400"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="10"	minRadius="400"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Primordial Mists -->

				<Orbitals distance="1" scale="light-minute" angle="random">
					<SpaceEnvironment 
							type=			"&sePrimordialNebula;"
							shape=			"circular" 
							width=			"120"
							widthVariation=	"100"

							encountersCount="1d4+2"
							>
						<Label attributes="primordial"/>
					</SpaceEnvironment>
				</Orbitals>

				<Orbitals count="2d3+1" distance="1d6+1" scale="light-minute" angle="random">
					<SpaceEnvironment 
							type=			"&sePrimordialMist;"
							shape=			"arc" 
							width=			"50"
							widthVariation=	"100"
							span=			"1d40+50"

							encountersCount="1d2"
							>
						<Label attributes="primordial"/>
					</SpaceEnvironment>
				</Orbitals>

				<!-- Worlds -->

				<Orbitals count="1d3+3" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="60" table="PrimordialPrimary"/>
							<Lookup chance="15" table="GreenhousePrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="5"  table="GasGiantPrimary"/>
							<Lookup chance="10" table="PrimordialGasGiantPrimary"/>
						</Table>
						<Table maxRadius="900">
							<Lookup chance="20" table="PrimordialPrimary"/>
							<Lookup chance="10" table="GreenhousePrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="43" table="PrimordialGasGiantPrimary"/>
							<Lookup chance="10" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="2"  table="AsteroidBelt25"/>
							<Lookup chance="1"  table="AsteroidBelt50"/>
						</Table>
						<Table maxRadius="3000">
							<Lookup chance="20" table="PrimordialPrimary"/>
							<Lookup chance="20" table="IcePrimary"/>
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="10" table="GasGiantPrimary"/>
							<Lookup chance="25" table="PrimordialGasGiantPrimary"/>
							<Lookup chance="3"  table="AsteroidBelt12"/>
							<Lookup chance="2"  table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</PrimordialSystem>

		<!-- RED DWARF SYSTEM ==================================================

			Cold
			Ice

		-->

		<RedDwarfSystem>
			<Group>
				<Station type="&stRedDwarfStar;" showOrbit="true"/>
				
				<AddAttribute attributes="redDwarfSystem"/>
				
				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="20"	minRadius="0"		maxRadius="190"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="190"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="65"	minRadius="0"		maxRadius="190"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="5"	minRadius="0"		maxRadius="190"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="20"	minRadius="190"		maxRadius="320"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="10"	minRadius="190"		maxRadius="320"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="50"	minRadius="190"		maxRadius="320"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="20"	minRadius="190"		maxRadius="320"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="320"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="20"	minRadius="320"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="40"	minRadius="320"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="30"	minRadius="320"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="4-5" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d100+740" angle="random">
					<Variants>
						<Table maxRadius="290">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="60" table="RockyPrimary"/>
							<Lookup chance="30" table="IcePrimary"/>
						</Table>
						<Table maxRadius="480">
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="40" table="IcePrimary"/>
							<Lookup chance="40" table="GasGiantPrimary"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="30" table="IcePrimary"/>
							<Lookup chance="40" table="MethaneGasGiantPrimary"/>
							<Lookup chance="5"  table="AsteroidBelt12"/>
							<Lookup chance="15" table="AsteroidBelt25"/>
							<Lookup chance="10" table="AsteroidBelt50"/>
						</Table>
					</Variants>
				</Orbitals>

				<!-- Comets -->

				<Orbitals count="1d4-1" scale="light-minute" distance="1d8+8" angle="random" eccentricity="1d20+70" rotation="random" exclusionRadius="100">
					<Lookup table="IceComet"/>
				</Orbitals>
			</Group>
		</RedDwarfSystem>

		<!-- VOLCANIC SYSTEM ===================================================

			Hot
			Metallic

		-->

		<VolcanicSystem>
			<Group>
				<Station type="&stRedGiantStar;"/>

				<AddAttribute attributes="redGiantSystem"/>
				
				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="60"	minRadius="0"		maxRadius="370"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="370"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="30"	minRadius="0"		maxRadius="370"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="0"	minRadius="0"		maxRadius="370"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="40"	minRadius="370"		maxRadius="620"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="10"	minRadius="370"		maxRadius="620"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="50"	minRadius="370"		maxRadius="620"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="0"	minRadius="370"		maxRadius="620"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="20"	minRadius="620"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="40"	minRadius="620"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="10"	minRadius="620"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="5-8" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Lookup	maxRadius="100" table="AsteroidVulcanoidBelt300"/>
						<Table maxRadius="300">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="10" table="GreenhousePrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="5"  table="RockyPrimary"/>
							<Lookup chance="65" table="VolcanicPrimary"/>
						</Table>
						<Table maxRadius="500">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="10" table="GreenhousePrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="10" table="RockyPrimary"/>
							<Lookup chance="50" table="VolcanicPrimary"/>
							<Lookup chance="10" table="GasGiantPrimary"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="5"  table="DesertPrimary"/>
							<Lookup chance="15" table="IcePrimary"/>
							<Lookup chance="5"  table="MetallicPrimary"/>
							<Lookup chance="55" table="GasGiantPrimary"/>
							<Lookup chance="5"  table="AsteroidBelt12"/>
							<Lookup chance="10" table="AsteroidBelt25"/>
							<Lookup chance="10" table="AsteroidBelt50"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</VolcanicSystem>

		<!-- YELLOW STAR SYSTEM ================================================
		-->

		<YellowStarSystem>
			<Group>
				<Station type="&stG-TypeStar;"/>

				<AddAttribute attributes="GTypeSystem"/>
				
				<!-- Inner Zone -->

				<Table>
					<AddTerritory chance="20"	minRadius="0"		maxRadius="370"		attributes="innerSystem, metallicComp, moltenZone"/>
					<AddTerritory chance="10"	minRadius="0"		maxRadius="370"		attributes="innerSystem, organicComp, greenhouseZone"/>
					<AddTerritory chance="70"	minRadius="0"		maxRadius="370"		attributes="innerSystem, rockyComp, cinderZone"/>
					<AddTerritory chance="0"	minRadius="0"		maxRadius="370"		attributes="innerSystem, waterComp, steamZone"/>
				</Table>

				<!-- Life Zone -->

				<Table>
					<AddTerritory chance="20"	minRadius="370"		maxRadius="620"		attributes="lifeZone, metallicComp, metallicZone"/>
					<AddTerritory chance="10"	minRadius="370"		maxRadius="620"		attributes="lifeZone, organicComp, primordialZone"/>
					<AddTerritory chance="60"	minRadius="370"		maxRadius="620"		attributes="lifeZone, rockyComp, desertZone"/>
					<AddTerritory chance="10"	minRadius="370"		maxRadius="620"		attributes="lifeZone, waterComp, biosphereZone"/>
				</Table>

				<!-- Outer Zone -->

				<Table>
					<AddTerritory chance="10"	minRadius="620"		maxRadius="0"		attributes="outerSystem, metallicComp, barrenZone"/>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, organicComp, tholinZone"/>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, rockyComp, frostZone"/>
					<AddTerritory chance="30"	minRadius="620"		maxRadius="0"		attributes="outerSystem, waterComp, iceZone"/>
				</Table>

				<!-- Worlds -->

				<Orbitals count="5-7" BodeDistanceStart="1d12+70" BodeDistanceEnd="1d110+760" angle="random">
					<Variants>
						<Table maxRadius="300">
							<Lookup chance="20" table="DesertPrimary"/>
							<Lookup chance="10" table="GreenhousePrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="50" table="RockyPrimary"/>
							<Lookup chance="10" table="GasGiantPrimary"/>
						</Table>
						<Table maxRadius="500">
							<Lookup chance="2"  table="DesertPrimary"/>
							<Lookup chance="5"  table="GreenhousePrimary"/>
							<Lookup chance="5"  table="IcePrimary"/>
							<Lookup chance="5"  table="MetallicPrimary"/>
							<Lookup chance="6"  table="RockyPrimary"/>
							<Lookup chance="70" table="GasGiantPrimary"/>
							<Lookup chance="4"  table="AsteroidBelt12"/>
							<Lookup chance="3"  table="AsteroidBelt25"/>
						</Table>
						<Table maxRadius="2000">
							<Lookup chance="10" table="DesertPrimary"/>
							<Lookup chance="25" table="IcePrimary"/>
							<Lookup chance="10" table="MetallicPrimary"/>
							<Lookup chance="20" table="RockyPrimary"/>
							<Lookup chance="20" table="GasGiantPrimary"/>
							<Lookup chance="10" table="AsteroidBelt12"/>
							<Lookup chance="5"	table="AsteroidBelt25"/>
						</Table>
					</Variants>
				</Orbitals>
			</Group>
		</YellowStarSystem>
		
	</SystemPartTable>

<!-- STARS -->

	<!-- Primordial Star -->

	<StationType UNID="&stPrimordialStar;"
		name=				"(primordial star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x4d, 0x41, 0x0f"
		maxLightRadius=		"400"

		attributes=			"generic, primordial, star"
		>

		<Image>
			<FilterColorize hue="49" saturation="60">
				<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512"/>
			</FilterColorize>
		</Image>
	</StationType>

	<!-- O-Type Star -->

	<StationType UNID="&stO-TypeStar;"
		name=				"(star)"
		scale=				"star"
		sovereign=			"&svIndependent;"

		attributes=			"star"
		>
	<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

	<!-- A-Type Star -->

	<StationType UNID="&stA-TypeStar;"
		name=				"(A class star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x12, 0x50, 0x79"
		maxLightRadius=		"800"

		attributes=			"generic, star"
		>

		<Image>
			<FilterColorize hue="203" saturation="75">
				<Image imageID="&rsAStar;" imageX="0" imageY="0" imageWidth="512" imageHeight="512"/>
			</FilterColorize>
		</Image>

	</StationType>

	<!-- G-Type Star -->

	<StationType UNID="&stG-TypeStar;"
		name=				"(G class star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x68, 0x63, 0x23"
		maxLightRadius=		"620"

		attributes=			"generic, star"
		>

		<Image>
			<FilterColorize hue="57" saturation="50">
				<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512"/>
			</FilterColorize>
		</Image>
	</StationType>

	<!-- K-Type Star -->

	<StationType UNID="&stK-TypeStar;"
		name=				"(K class star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x70, 0x44, 0x1a"
		maxLightRadius=		"620"

		attributes=			"generic, star"
		>

		<Image>
			<FilterColorize hue="30" saturation="63">
				<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512"/>
			</FilterColorize>
		</Image>
	</StationType>

	<!-- M-Type Star -->

	<StationType UNID="&stM-TypeStar;"
		name=				"(star)"
		scale=				"star"
		sovereign=			"&svIndependent;"

		attributes=			"star"
		>
	<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

	<!-- Nebula Star -->

	<StationType UNID="&stNebulaStar;"
		name=				"(nebula star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x43, 0x3d, 0x4d"
		maxLightRadius=		"400"

		attributes=			"generic, star"
		>

		<Image>
			<FilterColorize hue="262" saturation="12">
				<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512"/>
			</FilterColorize>
		</Image>
	</StationType>

	<!-- White Dwarf Star -->

	<StationType UNID="&stWhiteDwarfStar;"
		name=				"(star)"
		scale=				"star"
		sovereign=			"&svIndependent;"

		attributes=			"star"
		>
	<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

	<!-- Red Dwarf Star -->

	<StationType UNID="&stRedDwarfStar;"
		name=				"(red dwarf star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x59, 0x0e, 0x00"
		maxLightRadius=		"320"

		attributes=			"generic, star"
		>
	<Image imageID="&rsRedDwarfStar;" imageX="0" imageY="0" imageWidth="256" imageHeight="256" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

	<!-- Blue Giant Star -->

	<StationType UNID="&stBlueGiantStar;"
		name=				"(star)"
		scale=				"star"
		sovereign=			"&svIndependent;"

		attributes=			"star"
		>
	<Image imageID="&rsStar1;" imageX="0" imageY="0" imageWidth="512" imageHeight="512" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

	<!-- Red Giant Star -->

	<StationType UNID="&stRedGiantStar;"
		name=				"(red giant star)"
		scale=				"star"
		sovereign=			"&svIndependent;"
		spaceColor=			"0x59, 0x0e, 0x00"
		maxLightRadius=		"620"

		attributes=			"generic, star"
		>
	<Image imageID="&rsRedGiantStar;" imageX="0" imageY="0" imageWidth="512" imageHeight="512" imageFrameCount="0" imageTicksPerFrame="0"/>
	</StationType>

<!-- CODE ======================================================================

	Helper methods for use in system creation.

-->

	<Globals>
		(block Nil

			(setq trnCreateAllStargates (lambda (options)

				; The options parameter may have the following fields
				;
				;	beaconType:					The StationType of the beacons
				;									surrounding the stargate. The
				;									default is stStargateBeacon.
				;	corewardLocationCriteria:	The location criteria for coreward
				;									stargates. The default is:
				;									"++innerSystem; -asteroids; -gasGiant"
				;	corewardNode:				Node in topology that is closest to
				;									galactic center. Stargates leading
				;									to this node will look slightly
				;									different. The default is to look
				;									at the "defaultCorewardNode" static data in
				;									the adventure descriptor. If that is
				;									Nil also, all stargates are edgeward.
				;	edgewardLocationCriteria:	The location criteria for edgeward
				;									stargates. The default is:
				;									"++outerSystem; -asteroids; -gasGiant"
				;	stargateType:				The StationType to use. The default is
				;									stStargate.
				;
				; NOTE: If you add the "noAutoGateCreate" attribute to a system then this
				; function will not create a gate to that system.

				(block (allStargates corewardGate beaconType corewardLocationCriteria
						corewardNode edgewardLocationCriteria stargateType)

					; Get all options

					(setq beaconType (if (@ options 'beaconType) (@ options 'beaconType) &stStargateBeacon;))
					(setq corewardLocationCriteria (if (@ options 'corewardLocationCriteria) (@ options 'corewardLocationCriteria) "++innerSystem; -asteroids; -gasGiant"))
					(setq corewardNode (if (@ options 'corewardNode) (@ options 'corewardNode) (typGetStaticData (@ (typFind "a") 0) 'defaultCorewardNode)))
					(setq edgewardLocationCriteria (if (@ options 'edgewardLocationCriteria) (@ options 'edgewardLocationCriteria) "++outerSystem; -asteroids; -gasGiant"))
					(setq stargateType (if (@ options 'stargateType) (@ options 'stargateType) &stStargate;))

					; Find the gate that has the shortest path to the Core
					(setq allStargates (sysGetStargates))
					(setq corewardGate
						(if corewardNode
							(map allStargates '(reduceMin original) theGate
								(sysGetTopologyDistance (sysGetStargateDestinationNode theGate) corewardNode)
								)
							Nil
							)
						)
						
					; Enumerate all the stargates that this system should have.
					; Create those that are needed.
					
					(enum allStargates theGate
						(if (and
								(not (sysGetObjectByName theGate))
								(not (sysHasAttribute (sysGetStargateDestinationNode theGate) 'noAutoGateCreate))
								)
							(block (gateObj beacon1Pos beacon2Pos locationCriteria)
							
								; The coreward gate is usually in the inner system.
								; The others are in the outer system.
								(setq locationCriteria (if (eq theGate corewardGate)
									(list 'location corewardLocationCriteria)
									(list 'location edgewardLocationCriteria)
									))

								; Create the stargate
								(setq gateObj (sysCreateStargate
									stargateType
									locationCriteria
									theGate
									))
									
								; If we could not create the gate, it is probably because we did not
								; have enough locations. This should never happen, but just in case we
								; handle it here.
								
								(if (not gateObj)
									(setq gateObj (sysCreateStargate stargateType (sysVectorRandom Nil 120 10) theGate))
									)
									
								; The position of the beacons depends on whether the gate leads
								; to the core or not.
								
								(setq beacon1Pos (sysVectorPolarOffset gateObj 270 6))
								(if (eq theGate corewardGate)
									(setq beacon2Pos (sysVectorPolarOffset gateObj 90 6))
									(setq beacon2Pos (sysVectorPolarOffset gateObj 0 6))
									)
									
								; Create beacons
								(sysCreateStation beaconType beacon1Pos)
								(sysCreateStation beaconType beacon2Pos)
								)
							)
						)
					)
				))
			)
	</Globals>

</TranscendenceModule>
