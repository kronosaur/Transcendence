<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

<!-- CORPORATE HIERARCHY
	
	GLOBAL DATA

	statusKateM:		Status of player with respect to Kate Morgental
							Nil						= Never met
							'acquaintance			= Met once or twice
							'ally					= Player has helped
							'betrayedKatami			= Player did not help Mr. Katami
							'destroyedByPlayer		= Player killed her
							'destroyed				= She is dead

-->

	<Sovereign UNID="&svCorporate;"
			name="Corporate Hierarchy"
			alignment="constructive chaos"
			>
			
		<Events>
			<GetGlobalDockScreen>
				(switch
					; This only applies to corporate hierarchy stations
					(not (objMatches gSource Nil "sTAV +corporateCustoms;"))
						Nil
						
					; If the ship is radioactive then we refuse docking
					(shpIsRadioactive gPlayerShip)
						(if (objHasAttribute gSource "corporateDecon")
							(list &dsCommonwealthDecon; 10)
							(list &dsRefuseContamination; 10)
							)
						
					; If the player has committed crimes, then she's in trouble
					(geq (int (objGetData gPlayerShip "corpCrimeSeverity")) 2)
						(list &dsCorporateImprison; 8)
						
					Nil
					)
			</GetGlobalDockScreen>
		</Events>
		
		<AttributeDesc>
			<!-- Define item attributes so that the player can see which Corporation 
				created the item. -->
		
			<ItemAttribute label="Assembler"		criteria="* +assemblerCorp;"/>
			<ItemAttribute label="Bushido"			criteria="* +bushido;"/>
			<ItemAttribute label="EI"				criteria="* +ei;"/>
			<ItemAttribute label="Kabuto"			criteria="* +kabuto;"/>
			<ItemAttribute label="Makayev"			criteria="* +makayev;"/>
			<ItemAttribute label="NAMI"				criteria="* +nami;"/>
			<ItemAttribute label="OmniDefense"		criteria="* +omniDefense;"/>
			<ItemAttribute label="Pacific Defense"	criteria="* +pacificDefense;"/>
			<ItemAttribute label="Rasiermesser"		criteria="* +rasiermesser;"/>
			<ItemAttribute label="Solon"			criteria="* +solon;"/>
			<ItemAttribute label="Taikon"			criteria="* +taikon;"/>
		</AttributeDesc>
	</Sovereign>

	<!-- CorporateCruiser -->

	<ShipClass UNID="&scCorporateCruiser;"
			manufacturer=		"Rasiermesser"
			class=				"Corporate cruiser"
			type=				""
			defaultSovereign=	"&svCorporate;"

			attributes=			"capitalShip, corporate, genericClass, majorShip"
			   
			size=				"275"
			mass=				"25000"
			thrustRatio=		"2"
			maxSpeed=			"20"
			cargoSpace=			"1000"

			cyberDefenseLevel=	"8"

			explosionType=		"&vtThermoExplosion2;"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itHexaCarbideArmor;"
			count=				"16"
			/>
		
		<Devices>
			<Device deviceID="&itRasiermesserLauncher;" secondaryWeapon="true" minFireArc="340" maxFireArc="200"	posAngle="110" posRadius="60" posZ="0"/>
			<Device deviceID="&itRasiermesserLauncher;" secondaryWeapon="true" minFireArc="160" maxFireArc="20"		posAngle="250" posRadius="60" posZ="0"/>
			<Device deviceID="&itPlasmaShieldGenerator;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"3.0"
			rotationAccel=		"0.5"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"300"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"100"

					posX=		"-25"
					posY=		"0"
					sizeX=		"50"
					sizeY=		"40"
					/>
		</Interior>

		<Items>
			<Item count="40d20" item="&itGotha10Missile;"/>
			<Item count="2d12" item="&itPteracniumFuelRod;"/>
		</Items>

		<!-- Image and Effects -->

		<Image imageID="&rsCorporateCruiser;" imageWidth="230" imageHeight="230"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="180"	posRadius="0"	posZ="-10"	rotation="180"	sendToBack="*"/>
		</Effects>
		
		<!-- AI and Behavior -->
		
		<AISettings
			fireRateAdj=		"40"
			fireAccuracy=		"95"
			perception=			"4"
			/>

	</ShipClass>

	<!-- Adventurer Outfitters -->

	<StationType UNID="&stAdventurerOutfitters;"
			name=				"Adventurer Outfitters"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itGusokuArmor;"
			hitPoints=			"250"
			repairRate=			"3"
			fireRateAdj=		"15"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"---ru cu--- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="50"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations6;" imageX="0" imageY="640" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itHeavyIonBlaster;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"---ru cur--"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1)"
					/>

			<RandomItem count="1d12" 
					criteria=		"d~w -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"---ru cur--"
					enhanced=		"5"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>

			<RandomItem count="1d12" 
					criteria=		"a -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"---ru cur--"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1)"
					/>

			<RandomItem count="1d12" 
					criteria=		"u -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"---ru cur--"
					/>

			<RandomItem count="2d12" 
					criteria=		"m -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"---ru cur--"
					/>

			<RandomItem count="1d6" 
					criteria=		"adu -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"----- rucur"
					/>
		</Items>

		<Trade currency="credit" max="100000" replenish="5000">
			<Sell	criteria="m +Commonwealth; -Illegal; -NotForSale; -notStandard; L:4-6;" priceAdj="115" inventoryAdj="100"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="115"/>
			<Buy	criteria="adumfNU -Illegal; -ID; -NotForSale;"	priceAdj="50"/>
			<Buy	criteria="adumfNU -Illegal; -ID;"				priceAdj="10"/>

			<Refuel			criteria="f +BasicFuel; L:1-9;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-9;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-10;" priceAdj="100"/>
			<InstallDevice	criteria="d L:1-10;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="d L:1-10;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen "Welcome to Adventurer Outfitters! We've been serving mercenaries, explorers, and pilgrims since 2311.")
						</OnPaneInit>

						<Actions>
							<Action name="Dock Services" key="D" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action name="Commodities Exchange" key="C">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="83"	y="29" />
			<Port x="-83"	y="29" />
			<Port x="97"	y="-9" />
			<Port x="-97"	y="-9" />
			<Port x="84"	y="-72" />
			<Port x="-84"	y="-72" />
			<Port x="30"	y="-111" />
			<Port x="-30"	y="-111" />
		</DockingPorts>

	</StationType>

	<!-- Armor Dealer -->

	<StationType UNID="&stArmorDealer;"
			name=				"Corporate armor dealer"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"100"
			repairRate=			"1"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"ccuv- ----- ----- ----- -----"
			locationCriteria=	"+planetary"
			>

		<Names noArticle="true">Armor United; Brentano Armor; Carbellium Armor Systems;
				Dreadnought Armor; Enterprise Armor Dealer; Full Protection Systems;
				Gargantua Defense Systems; Hellforge Armor; Indomitable Armor Systems;
				Jacob's Armor; Krenel Armors, rce; Loki Defense Systems; Murasaki Armor Corporation;
				Nerling Armor Dealers; Ooro Armors; Pangea Protection Equipment;
				Quen Ho Armor; Ransom Armor Corporation; Sentinel Protection Equipment;
				Tenhove Defense Dealer; Umagahli Armor Systems; Viceroy Armor;
				Wei Chang Armor Dealer; %s Armor Systems</Names>

		<Image			imageID="&rsStations1;" imageX="256" imageY="256" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="10" 
					criteria=		"as -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"ucu--"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement1)"
					/>
			<RandomItem count="10" 
					criteria=		"as -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"-ucu-"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1)"
					/>
			<RandomItem count="5" 
					criteria=		"as -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"-rucu r"
					/>
			<RandomItem count="3" 
					criteria=		"as -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"--ruc ur"
					/>
			<RandomItem count="4" 
					criteria=		"u +ArmorRepair; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"ccuuu ur"
					/>

			<Item count="3d4"	item="&itAblativeArmorCoating;" />
			<Item count="1d2"	item="&itMonopoleDeflector;" />

			<Item chance="70" count="1d4"	item="&itCarbonWeaverNanos;" />
			<Item chance="10" count="1d4"	item="&itDegeneratingNanos;" />
			<Item chance="70" count="1d4"	item="&itReactiveArmorCoating;" />
			<Item chance="30" count="1d2"	item="&itReflectiveArmorCoating;" />
			<Item chance="10" count="1d2"	item="&itRegeneratingNanos;" />
			<Item chance="30" count="1d4"	item="&itEMPImmuneCoating;" />
		</Items>

		<Trade currency="credit" max="50000" replenish="2500">
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="110"/>
			<Buy	criteria="asU -Illegal; -NotForSale;"	priceAdj="90"/>
			<Buy	criteria="asU -Illegal; -ID;"				priceAdj="10"/>
			
			<RepairArmor	criteria="a L:1-7;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-7;" priceAdj="100"/>
			<InstallDevice	criteria="s L:1-7;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="s L:1-7;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<StaticData>
			<NPCService>
				(	;	service					level	margin
					(	'repairArmor			7		100		)
					)
			</NPCService>
		</StaticData>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are docked at an armor dealer station.">

						<Actions>
							<Action name="Armor and Shields" key="A" default="1">
								(scrShowScreen gScreen &dsRPGManageArmor; {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>
							
							<Action name="Commodities Exchange" key="C">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="64" />
			<Port x="64"	y="0" />
			<Port x="0"		y="0" />
			<Port x="50"	y="90" />
			<Port x="90"	y="20" />
		</DockingPorts>

	</StationType>

	<!-- Arms Dealer -->

	<StationType UNID="&stArmsDealer;"
			name=				"Corporate arms dealer"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"150"
			repairRate=			"2"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"uccr- ----- ----- ----- -----"
			locationCriteria=	"+planetary"
			>

		<Names noArticle="true">Azure Protection Systems; Bixbie Arms; Chiba Arms Dealers; 
				Dreadnought Arms; Excimer Systems; Farside Defense Systems;
				General Arms, rce; Hastur Weapons; Iberian Defense Systems;
				Jacob's Arms; Kraken Weapons, rce; Laser Armada; Ming Systems;
				Nrummer Weapons Corp.; Obelisk Weapons; Penitent Defender;
				Quixote Arms Corporation; Raptor Systems, rce; Security Weapons;
				Tenhove Defense Dealer; Ultimate Weapons; Victory Systems;
				Weapons World; %s Weapon Systems</Names>

		<Image			imageID="&rsStations1;" imageX="256" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="10" 
					criteria=		"w -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"c----"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement2)"
					/>
			<RandomItem count="15" 
					criteria=		"w -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"ucu--"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement1)"
					/>
			<RandomItem count="8" 
					criteria=		"w -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"rucur"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1)"
					/>

			<RandomItem count="20" 
					criteria=		"m -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"ucu--"
					/>
			<RandomItem count="10" 
					criteria=		"m -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"rucur"
					/>
		</Items>

		<Trade currency="credit" max="50000" replenish="2500">
			<Sell	criteria="m +Commonwealth; +BasicAmmo; -Illegal; -NotForSale; -notStandard;" priceAdj="110" inventoryAdj="100"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="110"/>
			<Buy	criteria="mwU -Illegal; -NotForSale;"	priceAdj="60"/>
			<Buy	criteria="mwU -Illegal; -ID;"				priceAdj="10"/>
			
			<InstallDevice	criteria="w L:1-5;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="w L:1-5;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>

			<OnCreate>
				; Pick a random upgrade
				(objSetData gSource "WeaponUpgrade" (random 0 5))
			</OnCreate>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen "You are docked at an arms dealer station.")
						</OnPaneInit>

						<Actions>
							<Action name="[W]eapons" default="1">
								(scrShowScreen gScreen &dsRPGManageWeapons; {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action name="Commodities Exchange" key="C">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="70" />
			<Port x="0"		y="-70" />
			<Port x="50"	y="50" />
			<Port x="50"	y="-50" />
			<Port x="70"	y="0" />
			<Port x="-70"	y="0" />
			<Port x="-50"	y="50" />
			<Port x="-50"	y="-50" />
		</DockingPorts>

	</StationType>

	<!-- Arms Dealer, Makayev -->

	<StationType UNID="&stArmsDealerMakayev;"
			name=				"Makayev-Energia Space Systems"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"&dsArmsDealerSpecial;"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itBlastPlate;"
			hitPoints=			"350"
			repairRate=			"5"
			fireRateAdj=		"20"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"--rur v---- ----- ----- -----"
			locationCriteria=	"+planetary"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations1;" imageX="256" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itMarkIHowitzer;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w +Makayev; -NotForSale;"
					levelFrequency=	"--ruc ur---"
					enhanced=		"10"
					enhancement=	"=(intMakayevWeaponEnhancement)"
					/>

			<RandomItem chance="65" count="1d4" 
					criteria=		"d~w +Makayev; -NotForSale;"
					levelFrequency=	"--ruc ur---"
					/>

			<RandomItem count="2d12" 
					criteria=		"a +Makayev; -NotForSale;"
					levelFrequency=	"--ruc ur---"
					enhanced=		"10"
					enhancement=	"=(intMakayevArmorEnhancement)"
					/>

			<Item chance="95"	count="3d100"	item="&itStrelkaRed;" />
			<Item chance="50"	count="3d100"	item="&itStrelkaBlack;" />
		</Items>

		<Trade currency="credit" max="50000" replenish="2500">
			<Sell	criteria="m +Makayev; -Military; -Illegal; -NotForSale;" priceAdj="120" inventoryAdj="500"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="120"/>

			<RepairArmor	criteria="a L:1-8;" priceAdj="100"/>
			<ReplaceArmor	criteria="a +makayev; L:1-7;" priceAdj="100"/>
			<InstallDevice	criteria="d +makayev; L:1-7;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-7;" priceAdj="100"/>
			
			<ReplaceArmor	criteria="a L:1-7;" priceAdj="unavailable"	messageID="descNoInstall"/>
			<InstallDevice	criteria="d L:1-7;" priceAdj="unavailable"	messageID="descNoInstall"/>
		</Trade>

		<StaticData>
			<LongName>"a Makayev-Energia weapons franchise"</LongName>
		</StaticData>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockingPorts>
			<Port x="0"		y="70" />
			<Port x="0"		y="-70" />
			<Port x="50"	y="50" />
			<Port x="50"	y="-50" />
			<Port x="70"	y="0" />
			<Port x="-70"	y="0" />
			<Port x="-50"	y="50" />
			<Port x="-50"	y="-50" />
		</DockingPorts>
		
		<Language>
			<Text id="descNoInstall">
				(cat
					"We only install Makayev items. "
					"We cannot install " (itmGetName (@ gData 'item) 0x04) " on your ship."
					)
			</Text>
			<Text id="dockServices:installAbility">
				(cat "We install Makayev items up to tech level " (objGetProperty gSource 'installDeviceMaxLevel) ".")
			</Text>
		</Language>
	</StationType>

	<!-- Arms Dealer, Bushido -->

	<StationType UNID="&stArmsDealerBushido;"
			name=				"Bushido merchant"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"&dsArmsDealerSpecial;"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itGusokuArmor;"
			hitPoints=			"300"
			repairRate=			"5"
			fireRateAdj=		"20"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"---ru rv--- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="50"
			>

		<Image			imageID="&rsStations1;" imageX="256" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itNeutronBlaster;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w +Bushido; -NotForSale;"
					levelFrequency=	"---ru cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoWeaponEnhancement)"
					/>

			<RandomItem count="1d12" 
					criteria=		"s +Bushido; -NotForSale;"
					levelFrequency=	"---ru cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoShieldEnhancement)"
					/>

			<RandomItem count="1d12" 
					criteria=		"a +Bushido; -NotForSale;"
					levelFrequency=	"---ru cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoArmorEnhancement)"
					/>

			<RandomItem count="1d12" 
					criteria=		"a +Bushido; -NotForSale;"
					levelFrequency=	"----- rucur"
					enhanced=		"5"
					enhancement=	"=(intBushidoArmorEnhancement)"
					/>
		</Items>

		<Trade currency="credit" max="50000" replenish="2500">
			<Sell	criteria="m +Bushido; -Illegal; -NotForSale;" priceAdj="120" inventoryAdj="300"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="120"/>

			<RepairArmor	criteria="a L:1-9;" priceAdj="100"/>
			<ReplaceArmor	criteria="a +bushido; L:1-10;" priceAdj="100"/>
			<InstallDevice	criteria="d +bushido; L:1-10;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-10;" priceAdj="100"/>
			
			<ReplaceArmor	criteria="a L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
			<InstallDevice	criteria="d L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
		</Trade>

		<StaticData>
			<LongName>"a Bushido arms dealer"</LongName>
		</StaticData>

		<DockingPorts>
			<Port x="0"		y="70" />
			<Port x="0"		y="-70" />
			<Port x="50"	y="50" />
			<Port x="50"	y="-50" />
			<Port x="70"	y="0" />
			<Port x="-70"	y="0" />
			<Port x="-50"	y="50" />
			<Port x="-50"	y="-50" />
		</DockingPorts>

		<Language>
			<Text id="descNoInstall">
				(cat
					"We only install Bushido items. "
					"We cannot install " (itmGetName (@ gData 'item) 0x04) " on your ship."
					)
			</Text>
			<Text id="dockServices:installAbility">
				(cat "We install Bushido items up to tech level " (objGetProperty gSource 'installDeviceMaxLevel) ".")
			</Text>
		</Language>

	</StationType>

	<!-- Auton Dealer -->

	<StationType UNID="&stAutonDealer;"
			name=				"Corporate auton dealer"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"350"
			repairRate=			"5"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"--rcu ur--- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="50"
			>

		<Names noArticle="true">Auton Universe; Brehzen's Used Autons; Chiba Auton Dealers;
				Dresden Autonomous Defenders; Ehrlenmeyer Autons; Frenzy Autons;
				General Autons, rce; Hastur Used Autons; Ixin Autons Dealer;
				Ji Autons; Kyrrin Used Autons; Laser Autons, rce; Merlin Autons;
				Nrummer Weapons Corp.; Oort Autons, rce; Planetary Autons;
				Qing Long Autons; Raptor Systems, rce; Security Autons;
				Tenhove Defense Dealer; Ultimate Autons; Victory Systems;
				Weapons World; %s Auton Dealers</Names>

		<Image			imageID="&rsStations4;" imageX="128" imageY="192" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="20" 
					criteria=		"* -Illegal; -Military; +Auton; -NotStandard; -NotForSale;"
					level=			"4"
					levelCurve=		"2"
					/>
		</Items>

		<Trade currency="credit" max="50000" replenish="2500">
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="110"/>
			<Buy	criteria="*NU +Auton; -Illegal; -NotForSale;"	priceAdj="90"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are docked at an auton dealer.">

						<Actions>
							<Action name="Buy Autons" default="1" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Sell Autons" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>

							<Action name="Repair Active Autons" key="R">
								(block Nil
									; Figure out the list of autons for the player
									(setq gList (sysFindObject gPlayerShip "s B:auton; O:escort;"))
									(if gList
										(scrShowPane gScreen "RepairAutons")
										(scrShowPane gScreen "NoAutons")
										)
									)
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<NoAutons
							desc=	"A sales droid approaches you: &quot;You do not currently have any autons to repair, but I would be delighted to show you some of our newest models.&quot;">

						<Actions>
							<Action name="Leave" cancel="1" default="1" key="L">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</NoAutons>

					<RepairAutons>
						<OnPaneInit>
							(block Nil
								; Figure out how much it would cost to repair the player's
								; autons.

								(setq gCost 0)
								(enum gList auton
									(for i 0 (subtract (shpGetArmorCount auton) 1)
										(setq gCost (add gCost (multiply 5 (objGetArmorDamage auton i))))
										)
									)

								(switch
									; If the autons have no damage, then there is nothing to do
									(eq gCost 0)
										(block Nil
											(scrSetDesc gScreen "There is no damage to your autons.")
											(scrEnableAction gScreen 0 Nil)
											)

									; If the player cannot afford it.
									(gr gCost (plyGetCredits gPlayer))
										(block Nil
											(scrSetDesc gScreen (cat "Repairing the damage to your autons would cost " gCost " credits. Unfortunately, you do not have enough credits to proceed."))
											(scrEnableAction gScreen 0 Nil)
											)

									; Otherwise, we're OK
									(scrSetDesc gScreen (cat "Repairing the damage to your autons will cost " gCost " credits. Do you wish to proceed?"))
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Repair" default="1" key="R">
								(block Nil
									(enum gList auton
										(for i 0 (subtract (shpGetArmorCount auton) 1)
											(objRepairArmor auton i)
											)
										)

									(plyCharge gPlayer gCost)
									(scrShowPane gScreen "Default")
									)
							</Action>

							<Action name="Leave" cancel="1" key="L">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</RepairAutons>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="90" />
			<Port x="0"		y="-90" />
			<Port x="60"	y="60" />
			<Port x="60"	y="-60" />
			<Port x="90"	y="0" />
			<Port x="-90"	y="0" />
			<Port x="-60"	y="60" />
			<Port x="-60"	y="-60" />
		</DockingPorts>

	</StationType>

	<!-- Corporate Enclave -->

	<StationType UNID="&stCorporateEnclave;"
			name=				"Corporate enclave"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"150"
			repairRate=			"2"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, friendly, independent, generic, human, majorStation, populated"
			levelFrequency=		"ruuur ----- ----- ----- -----"
			locationCriteria=	"-asteroids"
			>

		<Image			imageID="&rsStations1;" imageX="128" imageY="256" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="1d4+2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Trade currency="credit" max="50000" replenish="2500">
			<Buy	criteria="*NU +Lux; -Illegal;"	priceAdj="120"/>
			<Buy	criteria="*NU +Meds; -Illegal;"	priceAdj="120"/>
			<Buy	criteria="*NU +Food; -Illegal;"	priceAdj="110"/>
			<Buy	criteria="*NU +Res; -Illegal;"	priceAdj="105"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are in the docking level of a Corporate Enclave. The citizens of the station work for various members of the Corporate Hierarchy.">

						<Actions>
							<Action name="Corporate Level" default="1" key="C">
								<Navigate screen="CorporateLevel" />
							</Action>

							<Action name="Residential Level" key="R" id="residentialLevel">
								<ShowPane pane="ResidentialLevel"/>
							</Action>

							<Action name="Maintenance Level" key="M">
								(if (objGetItems gPlayerShip "*NU +Illegal; -ID")
									(scrShowPane gScreen "Illegals")
									(scrShowPane gScreen "MaintenanceLevel")
									)
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<Illegals
							desc=	"You are in the maintenance level of a Corporate Enclave. The door to the maintenance shop is open and you hear voices inside.">

						<Actions>
							<Action name="Enter Maintenance Shop" default="1" key="E">
								<ShowPane pane="MaintenanceShop"/>
							</Action>

							<Action name="Leave" cancel="1" key="L">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Illegals>

					<MaintenanceLevel
							desc=	"You are in the maintenance level of a Corporate Enclave. The drone of the atmosphere processors and the waste converters drowns out all other noises. There is an empty maintenance shop here filled with various machines and droids; an empty laudanum ampule peeks out from under the workbench.">

						<Actions>
							<Action name="Leave" default="1" cancel="1" key="L">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</MaintenanceLevel>

					<MaintenanceShop
							desc=	"You are in the maintenance shop surrounded by various machines and droids. There are four men in the room repairing various items. One of the men walks towards you and says, &quot;You must be the new delivery person. Show me what you've got to sell.&quot;">

						<Actions>
							<Action name="&quot;Sorry, you have me confused with someone else.&quot;" cancel="1" key="S">
								<ShowPane pane="Illegals"/>
							</Action>

							<Action name="&quot;The merchandise is in my cargo hold.&quot;" default="1" key="M">
								(block Nil
									(scrShowPane gScreen "Default")
									
									(scrShowSellScreen
										(lambda (theItem)
											(switch
												(itmMatches theItem "*NU +Illegal; -ID")
													(divide (multiply 90 (itmGetPrice theItem 'credit)) 100)
													
												Nil
												)
											)
								
										Nil						; obsolete
										
										'(
											Nil
											50000
											)
										)
									)
							</Action>
						</Actions>
					</MaintenanceShop>

					<ResidentialLevel
							desc=	"You are in the residential level of a Corporate Enclave. This level holds the apartments and dwelling units of mid-level corporate citizens. The units are small and somewhat homogenous, though everyone you meet seems happy.">

						<Actions>
							<Action name="Leave" default="1" cancel="1" key="L">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</ResidentialLevel>

				</Panes>
			</Main>

			<CorporateLevel>
				<Panes>
					<Default
							desc=	"You are in the corporate level of a Corporate Enclave. The day-to-day services and manufacturing of the various corporations are carried-out on this level.">

						<Actions>
							<Action name="Sell Items" default="1" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>

							<Action name="Leave" cancel="1" key="L">
								<Navigate screen="Main" />
							</Action>
						</Actions>
					</Default>

				</Panes>

			</CorporateLevel>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="95" />
			<Port x="0"		y="-85" />
			<Port x="50"	y="70" />
			<Port x="50"	y="-50" />
			<Port x="75"	y="0" />
			<Port x="-75"	y="0" />
			<Port x="-50"	y="70" />
			<Port x="-50"	y="-50" />
		</DockingPorts>

	</StationType>

	<!-- Fuel Depot -->

	<StationType UNID="&stFuelDepot;"
			name=				"Corporate fuel depot"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"100"
			repairRate=			"1"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"cccuu rv--- ----- ----- -----"
			locationCriteria=	"-outerSystem, +planetary"
			>

		<Names noArticle="true">Antares Fuel; Bapco Fuel; Cerulean Energy;
				Dilithium Fuels, rce; Energy Supplies, rce; Fentano Fuels;
				Gargantua Fuel Systems; Herenix Fuel &amp; Energy; Impala Refueling;
				Jerry's Ship Fuel; Konstantine Fuels; Lexi Starship Fuels; Miranda Fueling Depot;
				Ngari Fuels; Otomo Fuels; Pergium Fuel &amp; Supplies;
				Qi jin Fuels; Revenant Fuels; Sanchez Fuel;
				Tander Fuel &amp; Energy; Urion Fuels; Vanderberg Fuels;
				Wehesaken Fuel Depot; %s Fuel</Names>

		<Image imageID="&rsStations1;" imageX="156" imageY="512" imageWidth="100" imageHeight="192"/>

		<Ships>
			<Lookup count="1d2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="3">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<LevelTable count="1d3">
				<Item levelFrequency="cccur v----"	count="4d20"	item="&itHelium3FuelRod;" />
				<Item levelFrequency="-rucc urv--"	count="4d20"	item="&itHeliumAssembly;" />
				<Item levelFrequency="--ruc curv-"	count="4d20"	item="&itXenotiteFuelRod;" />
				<Item levelFrequency="----r uccur"	count="4d20"	item="&itPteracniumFuelRod;" />
				<Item levelFrequency="----- -rucc"	count="4d20"	item="&itHadronVacuumFuelCell;" />
			</LevelTable>
			
			<Item				count="4d20"	item="&itWaterIce;" />
			<Item chance="50"	count="2d20"	item="&itHydrogenGas;" />
			<Item chance="50"	count="2d20"	item="&itLiquidOxygen;" />
			<Item chance="50"	count="1"		item="&itSystemMapROM;" />
		</Items>

		<Trade currency="credit" max="5000" replenish="250">
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="100"/>

			<Refuel			criteria="f +BasicFuel; L:1-3;" priceAdj="80"/>
			<Refuel			criteria="f +BasicFuel; L:4-10;" priceAdj="90"/>
		</Trade>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(block (actionStatus)
								(scrSetDescTranslate gScreen 'desc)
								
								(setq actionStatus (rpgCalcDockServiceRefuelAction gSource gPlayerShip { }))
								(scrShowAction gScreen 'actionRefuel (@ actionStatus 'visible))
								(scrEnableAction gScreen 'actionRefuel (@ actionStatus 'enabled))
								(scrSetActionDesc gScreen 'actionRefuel (@ actionStatus 'desc))
								)
						</OnPaneInit>

						<Actions>
							<Action id="actionRefuel" default="1">
								(scrShowScreen gScreen "&dsRPGRefuel;")
							</Action>

							<Action id="actionBuy">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									})
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="95" />
			<Port x="0"		y="-55" />
			<Port x="50"	y="70" />
			<Port x="50"	y="-30" />
			<Port x="75"	y="10" />
			<Port x="-75"	y="10" />
			<Port x="-50"	y="70" />
			<Port x="-50"	y="-30" />
		</DockingPorts>
		
		<Language>
			<Text id="actionRefuel">"[R]efuel"</Text>
			<Text id="actionBuy">"[B]uy Items"</Text>
			<Text id="actionUndock">"[U]ndock"</Text>
			
			<Text id="desc">
				(cat 
					"Welcome to " (objGetName gSource) ", your most reliable source of starship fuel and a member of the Earth Industries Conglomerate.\n\n"
					"All our fuel has been produced to the exacting standards required by today's reactors. Please use the terminal to proceed with your transaction."
					)
			</Text>
		</Language>

	</StationType>

	<!-- Makayev Factory -->

	<StationType UNID="&stMakayevFactory;"
			name=				"Makayev manufacturing plant"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"700"
			repairRate=			"3"
			fireRateAdj=		"15"
			explosionType=		"&vtThermoExplosion2;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, majorStation, Makayev, populated"
			levelFrequency=		"----- rrur- ----- ----- -----"
			unique=				"inSystem"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="75"

			definiteArticle=	"true"
			>

		<Image imageID="&rsMakayevFactory;" imageX="0" imageY="0" imageWidth="150" imageHeight="256"/>

		<Ships>
			<Ship	count="1" class="&scManticore;" orders="guard"/>
			<Lookup count="1" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Ship	chance="40" class="&scManticore;" orders="guard"/>
				<Lookup chance="35" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itMarkVHowitzer;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="2d3"
					criteria=		"w +Makayev; -NotForSale;"
					levelFrequency=	"---ru cur--"
					enhanced=		"20"
					enhancement=	"=(intMakayevWeaponEnhancement)"
					/>

			<RandomItem count="2d6"
					criteria=		"a +Makayev; -NotForSale;"
					levelFrequency=	"---ru cur--"
					enhanced=		"20"
					enhancement=	"=(intMakayevArmorEnhancement)"
					/>

			<RandomItem count="2d3"
					criteria=		"w +Makayev; -NotForSale;"
					levelFrequency=	"----- rucur"
					enhanced=		"10"
					enhancement=	"=(intMakayevWeaponEnhancement)"
					/>

			<RandomItem count="2d6"
					criteria=		"a +Makayev; -NotForSale;"
					levelFrequency=	"----- rucur"
					enhanced=		"10"
					enhancement=	"=(intMakayevArmorEnhancement)"
					/>

			<RandomItem count="1d4"
					criteria=		"d~w +Makayev; -NotForSale;"
					levelFrequency=	"---cc ccuuu"
					/>
		</Items>

		<Trade currency="credit" max="100000" replenish="5000">
			<Sell	criteria="m +Makayev; -Illegal; -NotForSale;" priceAdj="110" inventoryAdj="800"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="110"/>

			<Refuel			criteria="f +BasicFuel; L:1-10;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-9;" priceAdj="100"/>
			<ReplaceArmor	criteria="a +makayev;" priceAdj="100"/>
			<InstallDevice	criteria="d +makayev;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-10;" priceAdj="100"/>
			
			<ReplaceArmor	criteria="a L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
			<InstallDevice	criteria="d L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
		</Trade>

		<StaticData>
			<NPCService>
				(	;	service					level	margin
					(	'repairArmor			9		100		)
					)
			</NPCService>
		</StaticData>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen "Welcome to Makayev-Energia!")
						</OnPaneInit>

						<Actions>
							<Action name="Dock Services" key="D" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Buy Items" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Repair Items" key="R">
								(scrShowScreen gScreen "&dsRPGRepairItem;" {
									criteria: "*~aD +Makayev;"
									priceAdj: 65
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>
						</Actions>

					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<DockingPorts>
			<Port x="22"	y="86" />
			<Port x="56"	y="35" />
			<Port x="69"	y="-39" />
			<Port x="33"	y="-75" />
			<Port x="-33"	y="-75" />
			
			<Port x="-69"	y="-39" />
			<Port x="-56"	y="35" />
			<Port x="-22"	y="86" />
		</DockingPorts>

		<Language>
			<Text id="descNoInstall">
				(cat
					"We only install Makayev items. "
					"We cannot install " (itmGetName (@ gData 'item) 0x04) " on your ship."
					)
			<Text id="dockServices:installAbility">
				(cat "We install Makayev items up to tech level " (objGetProperty gSource 'installDeviceMaxLevel) ".")
			</Text>
			</Text>
		</Language>

	</StationType>

	<!-- Manufacturing Plant
	
	EXTRA DATA

	itemsConsumed:		List of item types that we consume
	itemsConsumedDesc:	Description of the items that we want to buy
	itemsCreated:		List of item types that we create
	maxInventory:		Max credits worth of items to stock	
	
	-->

	<StationType UNID="&stManufacturingPlant;"
			name=				"Corporate manufacturing plant"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"350"
			repairRate=			"2"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, friendly, independent, generic, human, majorStation, populated"
			levelFrequency=		"-uuuu r---- ----- ----- -----"
			unique=				"inSystem"
			locationCriteria=	"-planetary"
			>
			
		<Names noArticle="true">Arcoter Industrials; Bosen-Haggen Manufacturing; Cloud9 Industrials;
			Dai-chi Plant %1%0; Electrox Manufacturing; Fahrenheit Technologies; Geotron Industries;
			Honoku-Tomashi Plant %1%0%0; Irene Sanchez Factory; Jorrell Scientific Plant %1%0%0;
			Kestrel Industrials; Lamar Industries; Marina-Maxwell Factory %1%0%0; Nordic Industrials;
			Oceana Manufacturing; Blue Planet Facility %1%0%0; Reich &amp; Balham Plant %1%0%0;
			Senpaku Hogei Manufacturing; Thalmann Industries; Ursa Majoris Manufacturing;
			Ventabot Manufacturing; WIZ Manufacturing; Yollensgard Industrials; Z%1 Manufacturing
		</Names>

		<Image			imageID="&rsManufacturingPlant;" imageWidth="150" imageHeight="220"/>

		<Ships>
			<Lookup count="1d4+2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Trade currency="credit" max="50000" replenish="2500">
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
			
			<OnCreate>
				(block (allItems itemsCreated itemsConsumed buyDesc totalItems)
					; Compute the max to create per item
					(setq maxInventory (multiply (random 1000 2000) (sysGetLevel)))
					(objSetData gSource "maxInventory" maxInventory)
					
					; Pick the items that we manufacture
					(setq allItems (shuffle (itmGetTypes "t -Res; -Fuel; -ID; -Illegal; -Art; -Antique; -Alien; -NotForSale; F:curv; &gt;$0 &lt;=$500 &lt;=6")))
					(setq totalItems (min (random 3 5) (count allItems)))
					(for i 1 totalItems
						(block (theType thePrice theCount)
							(setq theType (item allItems (subtract i 1)))
							(setq itemsCreated (append itemsCreated theType))
							
							; Create items
							(setq theCount (divide maxInventory (itmGetPrice (itmCreate theType 1) 'credit)))
							(objAddItem gSource	(itmCreate theType theCount))
								
							; Set trade line
							(objAddSellOrder gSource theType (random '(50 70 80 80 85 85 85 85 90)))
							)
						)
					(objSetData gSource "itemsCreated" itemsCreated)
						
					; Pick the items that we consume
					(setq allItems (shuffle (itmGetTypes "t +Res; -Illegal; -NotForSale; F:curv; &lt;=$250")))
					(setq totalItems (min (random 2 4) (count allItems)))
					(for i 1 totalItems
						(block (theType)
							(setq theType (item allItems (subtract i 1)))
							(setq itemsConsumed (append itemsConsumed theType))
							
							; Set trade line
							(objAddBuyOrder gSource theType (random '(150 130 120 120 115 115 115 110)))
							
							; Compose a line telling the player what we will buy
							(if (eq i 1)
								(setq buyDesc (cat "We are looking to buy " (itmGetName (itmCreate theType 1) 0x82)))
								(setq buyDesc (cat buyDesc
									(if (eq i totalItems) " and " ", ")
									(itmGetName (itmCreate theType 1) 0x82)
									(if (eq i totalItems) "." "")
									))
								)
							)
						)
					(objSetData gSource "itemsConsumed" itemsConsumed)
					(objSetData gSource "itemsConsumedDesc" buyDesc)
					
					; Register a timer so that we can resupply
					(sysAddObjRecurringTimerEvent 9000 gSource "OnManufacture")
					)
			</OnCreate>

			<OnManufacture>
				(block (totalConsumed manufactureRun)
					; Consume raw materials (and keep track of how much we are consuming)
					(setq totalConsumed 0)
					(enum (objGetItems gSource "*U +Res;") theItem
						(block Nil
							(setq totalConsumed (add totalConsumed (multiply (itmGetPrice theItem 'credit) (itmGetCount theItem))))
							(objRemoveItem gSource theItem)
							)
						)
						
					; Manufacture
					(setq manufactureRun (divide totalConsumed 5))
					(if (gr totalConsumed 0)
						(for i 1 5
							(block (theType theCount)
								(setq theType (random (objGetData gSource "itemsCreated")))
								(setq theCount (divide manufactureRun (itmGetPrice (itmCreate theType 1) 'credit)))
								(objAddItem gSource (itmCreate theType (max 1 theCount)))
								)
							)
						)
					)
			</OnManufacture>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
					
						<OnPaneInit>
							(scrSetDesc gScreen
								"You are in the docking level of a Corporate manufacturing plant. The station master greets you:\n\n"
								"\"Welcome to our manufacturing facilities! "
								(objGetData gSource "itemsConsumedDesc")
								"\""
								)
						</OnPaneInit>

						<Actions>
							<Action name="Buy Items" default="1" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									showInstallables: True
									})
							</Action>
							
							<Action name="Sell Items" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>
							
							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="101" />
			<Port x="67"	y="56" />
			<Port x="99"	y="-9" />
			<Port x="72"	y="-84" />
			<Port x="0"		y="-108" />
			<Port x="-72"	y="-84" />
			<Port x="-99"	y="-9" />
			<Port x="-67"	y="56" />
		</DockingPorts>

	</StationType>

	<!-- Merchant Prince Hotel -->

	<StationType UNID="&stHotel;"
			name=				"Corporate hotel"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"150"
			repairRate=			"4"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, majorStation, populated"
			levelFrequency=		"uuurr v---- ----- ----- -----"
			locationCriteria=	"*"
			>

		<Names definiteArticle="true">Beta Gemini Hotel; Honoku-Tomashi Hotel; Manchurian Oriental Hotel;
				Merchant Prince Hotel; Savanna Hotel; Seven Sisters Hotel;
				Virgin %s Hotel; %s Interstellar Hotel</Names>

		<Image			imageID="&rsStations2;" imageX="0" imageY="256" imageWidth="192" imageHeight="256"/>

		<Ships>
			<Lookup count="1d2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Trade currency="credit" max="25000" replenish="1250">
			<Buy	criteria="*NU +Lux; -Illegal;"	priceAdj="125"/>
			<Buy	criteria="*NU +Food; -Illegal;"	priceAdj="110"/>
			<Buy	criteria="*NU" item="&itWaterIce;"		priceAdj="110"/>
			<Buy	criteria="*NU" item="&itStimuzine;"		priceAdj="110"/>
			<Buy	criteria="*NU" item="&itMedicalSupplies;"		priceAdj="110"/>
			<Buy	criteria="*NU" item="&itBiofactorPaste;"		priceAdj="110"/>
			<Buy	criteria="*NU" item="&itHypermycin;"		priceAdj="110"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>

						<OnPaneInit>
							(scrSetDesc gScreen (cat "Welcome to " (objGetName gSource 4) "."))
						</OnPaneInit>

						<Actions>
							<Action name="Restaurant" key="R" >
								(block (hasID hasIllegals)
									; See if the player has a Black Market ID or
									; any illegal items

									(objEnumItems gPlayerShip "*U" theItem
										(block Nil
											(if (itmHasModifier theItem 'Illegal)
												(setq hasIllegals True)
												)

											(if (itmHasModifier theItem 'BlackMarketID)
												(setq hasID True)
												)
											)
										)

									; If the player has a Black Market ID then she is treated
									; with respect.
									;
									; If the player has illegal items, then she encounters
									; a black market recruiter or an enforcement unit.
									;
									; If the player has neither, then she feels out of place.

									(switch
										(objGetData gSource "Declined")
											(scrShowPane gScreen "Restaurant-NoRespect")

										hasID
											(scrShowPane gScreen "Restaurant-Respect")

										(objGetGlobalData gSource "EncounterDone")
											(scrShowPane gScreen "Restaurant-NoRespect")

										hasIllegals
											(scrShowPane gScreen "Restaurant-Illegals")

										(scrShowPane gScreen "Restaurant-NoRespect")
										)
									)
							</Action>

							<Action name="Loading Dock" key="L">
								<Navigate screen="LoadingDock"/>
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<Restaurant-Respect
							desc="As you enter the restaurant the maitre d' welcomes you warmly and shows you to a table. Envious patrons look on while you eat a wonderful dish of Hogei Salmon with organic yams and sweet plum sauce.">

						<Actions>
							<Action name="Leave" Key="L" default="1" cancel="1" >
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Restaurant-Respect>

					<Restaurant-NoRespect
							desc="The maitre d' leaves you waiting for several minutes. When he finally turns to you he coldly tells you that there are no tables available. You feel out of place here.">

						<Actions>
							<Action name="Leave" Key="L" default="1" cancel="1" >
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Restaurant-NoRespect>

					<Restaurant-Illegals
							desc="The maitre d' tells you that no tables are available and shows you to the bar instead. At the bar you strike up a conversation with two brothers from Eridani who seem to be a little evasive about their business.">

						<Actions>
							<Action name="Continue" Key="C" default="1">
								(block Nil
									(objSetGlobalData gSource "EncounterDone" True)
									(scrShowPane gScreen "Restaurant-Illegals2")
									)
							</Action>
							<Action name="Leave" Key="L" cancel="1" >
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Restaurant-Illegals>

					<Restaurant-Illegals2>

						<OnPaneInit>
							(block Nil
								(setq gItem (random (objGetItems gPlayerShip "*U +Illegal;")))
								(scrSetDesc gScreen (cat "As you finish dinner one of the brothers says, \"I wish I could get a hold of some " (itmGetName gItem 2) ".\" You respond:"))
								)
						</OnPaneInit>

						<Actions>
							<Action name="&quot;I have some on my ship!&quot;" Key="I" default="1" >
								(if (ls (random 1 20) 20)
									(scrShowPane gScreen "Restaurant-Illegals3")
									(scrShowPane gScreen "Restaurant-Busted")
									)
							</Action>
							<Action name="&quot;Sorry, I can't help you.&quot;" Key="S" cancel="1" >
								(block Nil
									(objSetData gSource "Declined" True)
									(scrShowPane gScreen "Restaurant-Illegals4")
									)
							</Action>
						</Actions>
					</Restaurant-Illegals2>

					<Restaurant-Illegals3>

						<OnPaneInit>
							(block Nil
								(setq gCost (multiply (itmGetPrice gItem 'credit) (itmGetCount gItem)))
								(scrSetDesc gScreen (cat "The brothers offer you " gCost " credits for " (itmGetName gItem 8) "."))
								)
						</OnPaneInit>

						<Actions>
							<Action name="Accept" Key="A" default="1" >
								<ShowPane pane="Restaurant-Illegals5"/>
							</Action>
							<Action name="Decline" Key="D" cancel="1" >
								(block Nil
									(objSetData gSource "Declined" True)
									(scrShowPane gScreen "Restaurant-Illegals4")
									)
							</Action>
						</Actions>
					</Restaurant-Illegals3>

					<Restaurant-Illegals4
							desc="Finding nothing else to talk about, you finish eating in silence.">

						<Actions>
							<Action name="Leave" Key="L" default="1" cancel="1" >
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Restaurant-Illegals4>

					<Restaurant-Illegals5
							desc="You exchange the merchandise for the money at the dock. As they are about to leave, one of the brothers hands you an identification chip and says, &quot;You probably won't find us here again, but use this at a black market station if you want to do more business.&quot;">

						<OnPaneInit>
							(block Nil
								(plyCredit gPlayer gCost)
								(plyRecordSellItem gPlayer gItem gCost)
								(objRemoveItem gPlayerShip gItem)
								(objAddItem gPlayerShip (itmCreate &itBlackMarketID; 1))
								(itmSetKnown &itBlackMarketID;)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Leave" Key="L" default="1" cancel="1" >
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Restaurant-Illegals5>

					<Restaurant-Busted>

						<OnPaneInit>
							(if (geq (plyGetCredits gPlayer) 1000)
								(block Nil
									(plyCharge gPlayer 1000)
									(scrSetDesc gScreen "The brothers pull out badges and guns. \"You are under arrest for the attempted sale of illegal merchandise. Normally you could be imprisoned for your crimes, but we're going to let you go with just a 1000 credit fine.\"")
									(setq gPaid True)
									)
								(block Nil
									(scrSetDesc gScreen "The brothers pull out badges and guns. \"You are under arrest for the attempted sale of illegal merchandise.\"")
									(setq gPaid Nil)
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" Key="C" default="1" cancel="1">
								(if gPaid
									(scrShowPane gScreen "Default")
									(block Nil
										(plyDestroyed gPlayer "was imprisoned for smuggling")
										(scrExitDock gScreen)
										)
									)
							</Action>
						</Actions>
					</Restaurant-Busted>

				</Panes>
			</Main>

			<LoadingDock>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen (cat "You are in the loading dock of " (objGetName gSource 4) "."))
						</OnPaneInit>

						<Actions>
							<Action name="Sell Items" key="S" default="1">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>

							<Action name="Leave" cancel="1" key="L">
								<Navigate screen="Main"/>
							</Action>
						</Actions>
					</Default>
				</Panes>

			</LoadingDock>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="-90" />
			<Port x="96"	y="-70" />
			<Port x="-96"	y="-70" />
			<Port x="105"	y="-25" />
			<Port x="-105"	y="-25" />
			<Port x="68"	y="-100" />
			<Port x="-68"	y="-100" />
			<Port x="70"	y="25" />
			<Port x="-70"	y="25" />
		</DockingPorts>

	</StationType>

	<!-- Ice Farm -->

	<StationType UNID="&stIceFarm;"
			name=				"Corporate ice farm"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itPlasteelPlate;"
			hitPoints=			"75"
			repairRate=			"1"
			explosionType=		"&vtBlastExplosion2;"
			ejectaType=			"&vtIceAsteroidEjecta;"

			attributes=			"corporate, corporateCustoms, envAir, envAvoidsFire, friendly, independent, generic, human, populated"
			levelFrequency=		"rccuu rv--- ----- ----- -----"
			locationCriteria=	"++outerSystem"
			>

		<Image			imageID="&rsStations1;" imageX="512" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Ship			count="1d3+1"	class="&scTenhoveSentinel;"	orders="patrol" patrolDist="5"/>
		</Ships>

		<Items>
			<Item				count="4d12"	item="&itEuropanIceMoss;" />
			<Item				count="1d12"	item="&itEuropanIceVodka;" />
			<Item chance="50"	count="2d12"	item="&itHogeiSalmon;" />
		</Items>

		<Trade currency="credit" max="10000" replenish="500">
			<Sell	criteria="*NU +Lux; -NotForSale;"	priceAdj="75"/>

			<Buy	criteria="*NU +Food; -Illegal; &lt;=$100 -NotForSale;"	priceAdj="150"/>
			<Buy	criteria="*NU" item="&itHydrocarbons;"		priceAdj="200"/>
			<Buy	criteria="*NU" item="&itHelium3FuelRod;"	priceAdj="200"/>
			<Buy	criteria="*NU" item="&itOrganicAcid;"		priceAdj="200"/>
			<Buy	criteria="*NU" item="&itMedicalSupplies;"	priceAdj="200"/>
			<Buy	criteria="*NU" item="&itHyperfiberRoll;"	priceAdj="200"/>
			<Buy	criteria="*NU" item="&itBiofactorPaste;"	priceAdj="200"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main
				name=			"Ice Farm"
				>

				<Panes>
					<Default
							desc=	"You are docked at an independent ice farm on a small asteroid. Cold and stale air blows out of a wheezing recycler and you hear the drone of struggling generators and pumps.">

						<Actions>
							<Action name="Buy Items" default="1" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Sell Items" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="40" />
			<Port x="0"		y="-60" />
			<Port x="60"	y="0" />
			<Port x="-60"	y="0" />
			<Port x="-60"	y="60" />
			<Port x="60"	y="-60" />
			<Port x="40"	y="-40" />
			<Port x="-40"	y="-40" />
		</DockingPorts>

	</StationType>

	<!-- Insurance Company

	GLOBAL DATA

	claims:			Number of times player has been resurrected
	insured:		True if player is insured

	-->

	<StationType UNID="&stInsuranceCompany;"
			name=				"Clavius Insurance Conglomerate"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"250"
			repairRate=			"4"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, corporateInsurance, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"-rrru r---- ----- ----- -----"
			unique=				"inSystem"
			locationCriteria=	"+planetary"

			definiteArticle=	"true"
			>

		<Image			imageID="&rsStations2;" imageX="0" imageY="0" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="1d4+2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Events>
			<GetGlobalResurrectPotential>
				(switch
					; If not insured, we never resurrect
					(not (typGetGlobalData &stInsuranceCompany; "insured"))
						0

					; We never resurrect in Huaramarca or Elysium
					(or (eq (sysGetNode) 'Huaramarca)
						(eq (sysGetNode) 'Elysium))
						0

					; If there are corporate stations in the system, then we are highly likely
					; to resurrect the player
					(sysFindObject Nil "TA +corporate;")
						100

					; Otherwise, we are not very likely (we'll only resurrect if no one else can help)
					1
					)
			</GetGlobalResurrectPotential>

			<OnGlobalResurrect>
				(block (rescueObj)
					; Increase claims
					(typIncGlobalData &stInsuranceCompany; "claims")
					(typSetGlobalData &stInsuranceCompany; "insured" Nil)

					; Put the player in a safe place and repair the ship
					(rpgRestorePlayer)

					; Create a rescue ship nearby
					(setq rescueObj (sysCreateShip 
						&scCorporateCruiser; 
						(sysVectorPolarOffset gPlayerShip (random 0 359) 5)
						&svCorporate;
						))

					(shpOrder rescueObj 'wait Nil 5)
					(shpOrder rescueObj 'gate)
					(objSendMessage gPlayerShip rescueObj "Insurance claim processed. Have a better one!")
					)
			</OnGlobalResurrect>

			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen (cat "Welcome to the " (sysGetName) " branch of the Clavius Insurance Conglomerate. Since 2071 we have been providing hazard insurance services to freelancers and entrepreneurs throughout Human Space."))
						</OnPaneInit>

						<Actions>
							<Action name="Purchase Insurance" default="1" key="P">
								(switch
									(objGetGlobalData gSource "insured")
										(scrShowPane gScreen "AlreadyInsured")

									(geq (objGetGlobalData gSource "claims") 3)
										(scrShowPane gScreen "TooRisky")

									(scrShowPane gScreen "BuyInsurance")
									)
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<AlreadyInsured
							desc= "You are already insured by our conglomerate. Rest assured that you are protected against all losses by the most comprehensive insurance in the Commonwealth.">

						<Actions>
							<Action name="Continue" cancel="1" default="1" key="C">
								<ShowPane pane="Default"/>
							</Action>

						</Actions>

					</AlreadyInsured>

					<TooRisky
							desc= "Unfortunately, we do not have an insurance product suitable for the risky lifestyle that you lead.">

						<Actions>
							<Action name="Continue" cancel="1" default="1" key="C">
								<ShowPane pane="Default"/>
							</Action>

						</Actions>

					</TooRisky>

					<BuyInsurance>
						<OnPaneInit>
							(block (desc claims priceAdj)
								(setq claims (objGetGlobalData gSource "claims"))

								; Compute the price based on prior claims

								(switch
									(or (not claims) (eq claims 0))
										(setq gCost 10000)

									(eq claims 1)
										(setq gCost 50000)

									(eq claims 2)
										(setq gCost 100000)

									(setq gCost 1000000)
									)

								; Include any global adjustments

								(if (setq priceAdj (objGetPlayerPriceAdj gSource { type:'corporateInsurance priorClaims:(if claims claims 0) }))
									(setq gCost (divide (multiply gCost priceAdj) 100))
									)

								; Compose text

								(setq desc (cat 
									"\"Our conglomerate specializes in providing full personal and property coverage against death and destruction. "
									"Claims are settled by full replacement of life and property, including resuscitation and cloning.\n\n"
									))

								(switch
									(not priceAdj)
										(setq desc (cat desc "\"Based on your risk profile we can offer you full coverage for " gCost " credits. "))

									(eq gCost 0)
										(setq desc (cat desc 
											"\"With your Corporate discount we can offer you full coverage for...let me see..."
											"wow, you must have some powerful friends! We can offer you full coverage free of charge! "
											))
										
									(setq desc (cat desc "\"With your Corporate discount we can offer you full coverage for " gCost " credits. "))
									)

								(switch
									(eq gCost 0)
										(scrSetDesc gScreen desc "Do you wish to accept our offer?\"")
										
									(ls (plyGetCredits gPlayer) gCost)
										(block Nil
											(scrSetDesc gScreen desc
												"Unfortunately, you cannot afford this service currently, but we urge you to return as soon as your financial situation improves.\""
												)
											(scrEnableAction gScreen 0 Nil)
											)

									(scrSetDesc gScreen desc "Do you wish to purchase this service?\"")
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Purchase" default="1" key="P">
								(if (geq (plyGetCredits gPlayer) gCost)
									(block Nil
										(objSetGlobalData gSource "insured" True)
										(plyCharge gPlayer gCost)
										(scrShowPane gScreen "Done")
										)
									)
							</Action>

							<Action name="Cancel" cancel="1" key="C">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>

					</BuyInsurance>

					<Done
							desc= "&quot;Thank you for your purchase. We wish you a long and happy life, secure in the knowledge that the oldest and most powerful insurance conglomerate stands behind you.&quot;">

						<Actions>
							<Action name="Continue" cancel="1" default="1" key="C">
								<ShowPane pane="Default"/>
							</Action>

						</Actions>

					</Done>

				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="135" />
			<Port x="0"		y="-15" />
			<Port x="50"	y="110" />
			<Port x="50"	y="10" />
			<Port x="75"	y="60" />
			<Port x="-75"	y="60" />
			<Port x="-50"	y="110" />
			<Port x="-50"	y="10" />
		</DockingPorts>

	</StationType>

	<!-- Taikon Ventures -->

	<StationType UNID="&stTaikonVentures;"
			name=				"Taikon Ventures"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itQuadroCarbideArmor;"
			hitPoints=			"450"
			repairRate=			"5"
			fireRateAdj=		"10"
			explosionType=		"&vtThermoExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"----- -uur- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="75"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations8;" imageX="0" imageY="448" imageWidth="128" imageHeight="192"/>

		<Ships>
			<Ship chance="75" class="&scBritannia;" orders="guard"/>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itHeavyIonBlaster;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d6" 
					criteria=		"d +Taikon; -NotStandard; -NotForSale"
					level=			"9"
					levelCurve=		"1"
					/>
			<RandomItem count="1d6" 
					criteria=		"a +Taikon; -NotStandard; -NotForSale"
					level=			"9"
					levelCurve=		"1"
					/>
			<RandomItem count="3d6" 
					criteria=		"m +Taikon; -NotStandard; -NotForSale"
					level=			"9"
					levelCurve=		"1"
					/>
			<RandomItem count="1d6" 
					criteria=		"* -NotStandard; -NotForSale;"
					level=			"9"
					levelCurve=		"1"
					/>
			<RandomItem count="2d6" 
					criteria=		"*~ad -Alien; -NotStandard; -NotForSale;"
					level=			"9"
					levelCurve=		"1"
					/>
			<RandomItem count="1d3" 
					criteria=		"* +Alien; -NotStandard; -NotForSale;"
					level=			"9"
					levelCurve=		"2"
					/>
			<Item	count="6d12" item="&itPteracniumFuelRod;"/>
		</Items>

		<Trade currency="rin" max="100000" replenish="5000">
			<Sell	criteria="*NU +Taikon;"				priceAdj="85"/>
			<Sell	criteria="*NU +RingerValuable;"		priceAdj="510"/>
			<Sell	criteria="*NU +Alien;"				priceAdj="125"/>
			<Sell	criteria="*NU -ID;"					priceAdj="100"/>

			<Refuel			criteria="f +unid:&itPteracniumFuelRod;;" priceAdj="85"/>
			<Refuel			criteria="f +BasicFuel; L:1-10;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-11;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-11;" priceAdj="100"/>
			<InstallDevice	criteria="d L:1-11;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-11;" priceAdj="100"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are docked at a Taikon Ventures station.">

						<Actions>
							<Action name="Dock Services" default="1" key="D">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Buy Items" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>
					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="68"	y="35" />
			<Port x="42"	y="-71" />
			<Port x="-74"	y="-39" />
			<Port x="-38"	y="63" />
			<Port x="90"	y="-31" />
			<Port x="-28"	y="-90" />
			<Port x="-101"	y="21" />
			<Port x="36"	y="88" />
		</DockingPorts>

	</StationType>

	<!-- Trading Post -->

	<StationType UNID="&stCorporateTradingPost;"
			name=				"Corporate trading post"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"350"
			repairRate=			"5"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"---rc uur-- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="50"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations4;" imageX="0" imageY="448" imageWidth="192" imageHeight="192"/>

		<Animations>
			<Animation x="-39" y="-45">
				<Image	imageID="&rsTradingPostAnimation;" imageX="0" imageY="0" imageWidth="64" imageHeight="80" imageFrameCount="40" imageTicksPerFrame="4" />
			</Animation>
		</Animations>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="10" 
					criteria=		"* -Illegal; -Military; -Alien; -Specialty; -NotStandard; -NotForSale;"
					level=			"5"
					levelCurve=		"0"
					/>
			<RandomItem count="15" 
					criteria=		"* -Illegal; -Military; -Alien; -Specialty; -NotStandard; -NotForSale;"
					level=			"6"
					levelCurve=		"1"
					/>
			<RandomItem count="8" 
					criteria=		"* -Illegal; -Military; -Alien; -Specialty; -NotStandard; -NotForSale;"
					level=			"7"
					levelCurve=		"2"
					/>
		</Items>

		<Trade currency="credit" max="250000" replenish="12500">
			<Sell	criteria="*NU -Illegal; -NotForSale; -ID;"	priceAdj="110"/>
			<Buy	criteria="amswNU -Illegal; -NotForSale;"	priceAdj="45"/>
			<Buy	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="85"/>
			<Buy	criteria="*NU -Illegal; -ID;"				priceAdj="10"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>

			<OnObjDestroyed>
				(if (and (eq (objGetData gSource "MissionStatus") "intransit")
						(eq aObjDestroyed (objGetObjRefData gSource "Transport")))
					(block Nil
						(objSetData gSource "MissionStatus" "failed")
						)
					)
			</OnObjDestroyed>

			<OnObjDocked>
				(if (and (eq (objGetData gSource "MissionStatus") "intransit")
						(eq aObjDocked (objGetObjRefData gSource "Transport"))
						(eq aDockTarget gSource))
					(block Nil
						(objRemoveItem aObjDocked (objGetData gSource "Order"))
						(objSetData gSource "MissionStatus" "arrived")
						)
					)
			</OnObjDocked>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are docked at a Corporate Trading Post.">

						<Actions>
							<Action name="Order Items" key="O" default="1">
								(switch
									(eq (objGetData gSource "MissionStatus") "intransit")
										(scrShowScreen gScreen "OrderInTransit")

									(eq (objGetData gSource "MissionStatus") "arrived")
										(scrShowScreen gScreen "OrderReady")

									(eq (objGetData gSource "MissionStatus") "failed")
										(scrShowScreen gScreen "OrderFailed")

									; If the player has exceeded quota, then she cannot order
									(geq (objGetData gSource "OrderCount") 1)
										(scrShowScreen gScreen "QuotaExceeded")

									; Show order screen	
									(scrShowScreen gScreen "OrderItem")
									)
							</Action>

							<Action name="Buy Items" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
									checkMilitaryID: True
									showInstallables: True
									})
							</Action>

							<Action name="Sell Items" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell; {
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

			<OrderItem>

				<Panes>
					<Default
							desc="Please enter an item to search for in our catalog database:"
							showTextInput="true">

						<Actions>
							<Action name="Order" default="1">
								(block Nil
									(setq gItem (itmCreateByName "* -Illegal; -Military; -Alien; -ID; -CannotOrder; -NotForSale; &lt;10" (scrGetInputText gScreen) 1))

									(switch
										; If we couldn't understand, say so
										(not gItem)
											(scrShowPane gScreen "UnknownItem")

										; Otherwise, ask for a count
										(block Nil
											(setq gCost (itmGetActualPrice gItem))

											; Add 40% markup
											(setq gCost (divide (multiply gCost 140) 100))

											; Compute max count
											(switch
												(leq (itmGetFrequency gItem) 1)
													(setq gMaxCount 1)

												(leq (itmGetFrequency gItem) 4)
													(setq gMaxCount (itmGetMaxAppearing gItem))

												(leq (itmGetFrequency gItem) 10)
													(setq gMaxCount (multiply 3 (itmGetMaxAppearing gItem)))

												(setq gMaxCount (multiply 10 (itmGetMaxAppearing gItem)))
												)

											(scrShowPane gScreen "GetCount")
											)
										)
									)
							</Action>

							<Action name="Cancel" cancel="1">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Default>

					<GetCount
							showCounter="true">

						<OnPaneInit>
							(scrSetDesc gScreen
								(cat "The catalog contains a listing for " (itmGetName gItem 0x102) ". "
									(if (eq gMaxCount 1) "There is one left in the warehouse." (cat "There are " gMaxCount " left in the warehouse."))
									"\n\nHow many do you wish to order?"
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Order" default="1" key="O">
								(switch
									(gr (scrGetCounter gScreen) gMaxCount)
										(scrSetCounter gScreen gMaxCount)

									(gr (scrGetCounter gScreen) 0)
										(block Nil
											(setq gItem (itmCreate (itmGetType gItem) (scrGetCounter gScreen)))
											(scrShowPane gScreen "ConfirmOrder")
											)
									)
							</Action>

							<Action name="Cancel" cancel="1" key="C">
								(scrShowPane gScreen "Default")
							</Action>
						</Actions>
					</GetCount>

					<ConfirmOrder>

						<OnPaneInit>
							(block (desc shippingCost eachItem)
								; Shipping cost 500 credits per ton
								(setq shippingCost (multiply 500 (divide (add (multiply (itmGetMass gItem) (itmGetCount gItem)) 999) 1000)))

								; Compute price of each item
								(setq eachItem (itmGetActualPrice gItem))

								; Charge a 40% markup
								(setq eachItem (divide (multiply eachItem 140) 100))

								; Compute total cost
								(setq gCost (add (multiply (itmGetCount gItem) eachItem) shippingCost))

								(setq desc
									(cat "Order: " (itmGetName gItem 0x108) "\n"
										"Unit price: " eachItem
											(if (gr (itmGetCount gItem) 1) (cat " (" (itmGetCount gItem) " for " (multiply eachItem (itmGetCount gItem)) ")") "")
											"\n"
										"Shipping &amp; Handling: " shippingCost "\n"
										"Total: " gCost "\n\n"
										)
									)

								(if (gr gCost (plyGetCredits gPlayer))
									(setq desc (cat desc "Unfortunately, you do not have enough credits to complete the order."))
									(setq desc (cat desc "Do you wish to place the order?"))
									)

								(scrSetDesc gScreen desc)
								(scrEnableAction gScreen 0 (leq gCost (plyGetCredits gPlayer)))
								)
						</OnPaneInit>

						<Actions>
							<Action name="Place Order" default="1" key="P">
								(block (transport)
									; Create a transport at the nearest gate and put the item on it
									(setq transport (sysCreateShip &scEI100; (objGetNearestStargate gSource) &svCorporate;))
									(objAddItem transport gItem)

									; Order the transport to dock with the station and then gate out
									(shpOrderDock transport gSource)
									(shpOrderWait transport (random 5 10))
									(shpOrderGate transport)

									; Register the transport so we know if it got destroyed
									(objRegisterForEvents gSource transport)

									; Remember the item and the transport
									(objSetData gSource "Order" gItem)
									(objSetObjRefData gSource "Transport" transport)

									; Set the mission status
									(objSetData gSource "MissionStatus" "intransit")

									; Charge the player
									(plyCharge gPlayer gCost)
									(plyRecordBuyItem gPlayer gItem gCost)
									(objIncData gSource "OrderCount" 1)

									(scrShowPane gScreen "ThankYou")
									)
							</Action>

							<Action name="Cancel" cancel="1" key="C">
								(scrShowPane gScreen "Default")
							</Action>
						</Actions>

					</ConfirmOrder>

					<ThankYou
							desc="Your order has been placed and will be ready as soon as it arrives. Please check back at this screen to see the status of your order.">

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</ThankYou>

					<UnknownItem
							desc="Sorry, there are no items in the catalog matching that description."
							>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(scrShowPane gScreen "Default")
							</Action>
						</Actions>
					</UnknownItem>
				</Panes>
			</OrderItem>

			<OrderInTransit>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen
								(cat "Your order for " (itmGetName (objGetData gSource "Order") 0x108) " has been placed and is in route. "
									"The transport holding your order is currently " (objGetDistance gSource (objGetObjRefData gSource "Transport")) " light-seconds away."
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Default>
				</Panes>
			</OrderInTransit>

			<OrderReady>

				<Panes>
					<Default>
						<OnPaneInit>
							(block (spaceNeeded)
								(setq gItem (objGetData gSource "Order"))
								(setq spaceNeeded (multiply (itmGetMass gItem) (itmGetCount gItem)))

								(if (geq (objGetCargoSpaceLeft gPlayerShip) spaceNeeded)
									(block Nil
										(scrSetDesc gScreen (cat "Your order for " (itmGetName gItem 0x108) " has arrived and has been placed in your cargo hold.\n\nThank you for your business!"))
										(setq gResult True)
										)
									(block Nil
										(scrSetDesc gScreen (cat "Your order for " (itmGetName gItem 0x108) " is ready. Unfortunately, you do not have enough room in your cargo hold. Please return when you have freed up enough room."))
										(setq gResult Nil)
										)
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(block Nil
									(if gResult
										(block Nil
											(itmSetKnown gItem)
											(objAddItem gPlayerShip gItem)
											(objSetData gSource "MissionStatus" Nil)
											)
										)
									(scrShowScreen gScreen "Main")
									)
							</Action>
						</Actions>
					</Default>
				</Panes>
			</OrderReady>

			<OrderFailed>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen
								(cat "We regret to inform you that your order for " (itmGetName (objGetData gSource "Order") 0x108) " has been destroyed in transit. "
									"As we are not liable for losses due to external events, we respectfully recommend that you pursue the matter with your insurance company, if any."
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(block Nil
									(objSetData gSource "MissionStatus" Nil)
									(scrShowScreen gScreen "Main")
									)
							</Action>
						</Actions>
					</Default>
				</Panes>
			</OrderFailed>

			<QuotaExceeded>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen
								(cat "Sorry, only one order per customer!\n\nPlease buy our in-stock items or visit another Trading Post at a system near you.")
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Default>
				</Panes>
			</QuotaExceeded>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="92" />
			<Port x="38"	y="85" />
			<Port x="105"	y="60" />
			<Port x="124"	y="-20" />
			<Port x="64"	y="-92" />
			<Port x="0"		y="-120" />
			<Port x="-102"	y="-66" />
			<Port x="-100"	y="16" />
			<Port x="-84"	y="78" />
		</DockingPorts>

	</StationType>

	<!-- Wondrous Devices -->

	<StationType UNID="&stWondrousDevices;"
			name=				"Thor's Wondrous Devices"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"350"
			repairRate=			"5"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			levelFrequency=		"---ru ur--- ----- ----- -----"
			locationCriteria=	"+planetary"
			enemyExclusionRadius="50"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations5;" imageX="128" imageY="384" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="10" 
					criteria=		"admu -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"----c -----"
					enhanced=		"5"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>
			<RandomItem count="15" 
					criteria=		"admu -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"----u cu---"
					enhanced=		"5"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>
			<RandomItem count="8" 
					criteria=		"admu -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"----r ucur-"
					enhanced=		"1"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>
		</Items>

		<Trade currency="credit" max="250000" replenish="12500">
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="110"/>
			<Buy	criteria="admuNU -Illegal; -ID; -NotForSale;"	priceAdj="90"/>
			<Buy	criteria="admuNU -Illegal; -ID;"				priceAdj="10"/>
			
			<Refuel			criteria="f +BasicFuel; L:1-8;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-8;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-9;" priceAdj="100"/>
			<InstallDevice	criteria="d L:1-9;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="d L:1-9;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default
							desc=	"You are docked at a franchise of Thor's Wondrous Devices.">

						<Actions>
							<Action name="Dock Services" key="D" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action name="Commodities Exchange" key="C">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange; {
									checkMilitaryID: True
									})
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="90"	y="15" />
			<Port x="-90"	y="15" />
			<Port x="90"	y="90" />
			<Port x="-90"	y="90" />
			<Port x="60"	y="-30" />
			<Port x="-60"	y="-30" />

			<Port x="0"		y="-50" />
			<Port x="0"		y="130" />
		</DockingPorts>

	</StationType>

	<Globals>
		(block Nil
			(setq intBushidoArmorEnhancement (lambda Nil
				(random (list 0x0101 0x0102 0x0102 0x0103 0x0309 0x0329))
				))

			(setq intBushidoShieldEnhancement (lambda Nil
				(random (list 0x0101 0x0102 0x0102 0x0103 0x0104 0x0824 0x0842 0xf03))
				))

			(setq intBushidoWeaponEnhancement (lambda Nil
				(random (list 0x0101 0x0102 0x0102 0x0103 0x0f03 0x1002))
				))

			(setq intCorporateCrime (lambda (severity description)
				(if (gr severity (int (objGetData gPlayerShip "corpCrimeSeverity")))
					(block Nil
						(objSetData gPlayerShip "corpCrimeSeverity" severity)
						(objSetData gPlayerShip "corpCrime" description)
						)
					)
				))

			(setq intCorporateGenerateEnhancement (lambda (theItem)
				(block (theCategory)
					(setq theCategory (itmGetCategory theItem))
					(switch
						; Armor enhancements
						(eq theCategory 0x0002)
							(random (list 0x0101 0x0102 0x0102 0x0103))

						; Shield enhancements
						(eq theCategory 0x0080)
							(random (list 0x0101 0x0102 0x0102 0x0103))

						; Weapon enhancements
						(eq theCategory 0x0004)
							(random (list 0x0101 0x0102 0x0102 0x0103))

						0x0000
						)
					)
				))

			(setq intCorporateOnDestroy (lambda Nil
				(block (corporateCruiser theDestroyer)
					; Destroy items on the station
					(intDestroyItems gSource)

					; Create a corporate cruiser to avenge the station
					(setq corporateCruiser
						(sysCreateShip &scCorporateCruiser; (objGetNearestStargate gSource) &svCorporate;)
						)

					; If someone destroyed the station, avenge
					(setq theDestroyer aOrderGiver)
					(if (and theDestroyer
							(objCanAttack theDestroyer)
							(not (eq (objGetSovereign theDestroyer) &svCorporate;)))
						(block Nil
							(objSendMessage gPlayerShip gSource "Security alert! Deploy corporate enforcer!")
							(shpOrderAttack corporateCruiser theDestroyer)

							; Since the cruiser is busy, deploy some transports to loot the station
							(for i 1 (random 1 3)
								(block (transport)
									(setq transport
										(sysCreateShip &scEI500; (objGetNearestStargate gSource) &svCorporate;)
										)

									(shpOrderLoot transport gSource)
									(shpOrderGate transport)
									)
								)
							)
						)

					; If the player destroyed the station, then she is banned
					(if (and gPlayerShip (eq aOrderGiver gPlayerShip))
						(intCorporateCrime 3 (cat "the destruction of " (objGetName gSource 4)))
						)

					; Take all the items from the station (so that others won't loot it)
					(shpOrderLoot corporateCruiser gSource)

					; Gate out
					(shpOrderGate corporateCruiser)
					)
				))

			(setq intHPEnhancement1 (lambda Nil
				(random (list 0x0101 0x0101 0x0102 0x0102 0x0103))
				))

			(setq intHPEnhancement2 (lambda Nil
				(random (list 0x0101 0x0102 0x0102 0x0103 0x0103 0x0104))
				))

			(setq intHPEnhancement3 (lambda Nil
				(random (list 0x0102 0x0103 0x0103 0x0104 0x0104 0x0105))
				))

			(setq intMakayevArmorEnhancement (lambda Nil
				(random (list 0x0101 0x0102 0x0102 0x0103 0x0103 0x0104 0x0b00 0x0c00))
				))

			(setq intMakayevWeaponEnhancement (lambda Nil
				(random (list 0x0102 0x0103 0x0103 0x0104 0x0104 0x0105))
				))
			)
	</Globals>

	<!-- Arms Dealer Screen -->

	<DockScreen UNID="&dsArmsDealerSpecial;">
		<Panes>
			<Default>
				<OnPaneInit>
					(scrSetDesc gScreen (cat "You are docked at " (objGetStaticData gSource "LongName") "."))
				</OnPaneInit>

				<Actions>
					<Action name="Dock Services" key="D" default="1">
						(rpgDockServices gPlayerShip {
							checkMilitaryID: True
							})
					</Action>

					<Action name="Buy Items" key="B">
						(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy; {
							checkMilitaryID: True
							})
					</Action>

					<Action name="Undock" cancel="1" key="U">
						<Exit/>
					</Action>
				</Actions>

			</Default>
		</Panes>
	</DockScreen>

	<!-- Corporate Imprison -->

	<DockScreen UNID="&dsCorporateImprison;"	nestedScreen="true">

		<Panes>
			<Default>
				<OnPaneInit>
					(scrSetDesc gScreen (cat "As you enter the station you are surrounded by heavily armed soldiers. A Corporate officer approaches you: \"You are under arrest for " (objGetData gPlayerShip "corpCrime") "\"" ))
				</OnPaneInit>

				<Actions>
					<Action name="Continue" default="1" cancel="1" key="C">
						(block Nil
							(plyDestroyed gPlayer (cat "was imprisoned for " (objGetData gPlayerShip "corpCrime")))
							(scrExitScreen gScreen 'forceUndock)
							)
					</Action>
				</Actions>

			</Default>
		</Panes>
	</DockScreen>
	
<!-- BASE CLASSES -->
	
	<!-- Corporate Hierarchy Station Base Class
	
	USAGE: Corporate stations should inherit from this class. Derrived classes
		should manually call OnCreate and OnDestroy in case they need to override
		those events.
	
	-->
	
	<StationType unid="&baCorporateStation;"
			name=			"(Corporate station base class)"
			virtual=		"true"
			>
		
		<Events>
			<OnDestroy>
				(intCorporateOnDestroy)
			</OnDestroy>
		</Events>
	</StationType>

<!-- TABLES -->

	<ShipTable unid="&tbCorpDefenders;">
		<LevelTable>
			<Ship levelFrequency="cccr- -----" count="1" class="&scRoninA;" orders="guard"/>
			<Ship levelFrequency="ruucc cr---" count="1" class="&scRoninB;" orders="guard"/>
			<Ship levelFrequency="uuucc cur--" count="1" class="&scWolfen;" orders="guard"/>
			<Ship levelFrequency="---uu ccccu" count="1" class="&scRoninC;" orders="guard"/>
			<Ship levelFrequency="ccccc ccccc" count="1" class="&scCenturion;" orders="guard"/>
			<Ship levelFrequency="--ruc cuuuu" count="1" class="&scManticore;" orders="guard"/>
			<Ship levelFrequency="----- -uuuu" count="1" class="&scBritannia;" orders="guard"/>
		</LevelTable>
	</ShipTable>
	
<!-- RESOURCES -->

	<Image UNID="&rsCorporateCruiser;"		bitmap="Resources\CorporateCruiser.jpg" bitmask="Resources\CorporateCruiserMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsMakayevFactory;"		bitmap="Resources\MakayevFactory.jpg" bitmask="Resources\MakayevFactoryMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsManufacturingPlant;"	bitmap="Resources\ManufacturingPlant.jpg" bitmask="Resources\ManufacturingPlantMask.bmp" loadOnUse="true"/>
	
	<Image UNID="&rsTradingPostAnimation;"	bitmap="Resources\TradingPostGenericAd.jpg" bitmask="Resources\TradingPostGenericAdMask.bmp" loadOnUse="true"/>

</TranscendenceModule>